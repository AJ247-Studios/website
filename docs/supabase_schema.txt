1) List all tables (non-system)

| table_schema | table_name                 |
| ------------ | -------------------------- |
| auth         | audit_log_entries          |
| auth         | flow_state                 |
| auth         | identities                 |
| auth         | instances                  |
| auth         | mfa_amr_claims             |
| auth         | mfa_challenges             |
| auth         | mfa_factors                |
| auth         | oauth_authorizations       |
| auth         | oauth_client_states        |
| auth         | oauth_clients              |
| auth         | oauth_consents             |
| auth         | one_time_tokens            |
| auth         | refresh_tokens             |
| auth         | saml_providers             |
| auth         | saml_relay_states          |
| auth         | schema_migrations          |
| auth         | sessions                   |
| auth         | sso_domains                |
| auth         | sso_providers              |
| auth         | users                      |
| public       | comments                   |
| public       | deliverable_assets         |
| public       | deliverables               |
| public       | hero_slots                 |
| public       | images                     |
| public       | media                      |
| public       | media_assets               |
| public       | notifications              |
| public       | portfolio_items            |
| public       | profiles                   |
| public       | project_clients            |
| public       | project_members            |
| public       | projects                   |
| public       | site_images                |
| realtime     | messages                   |
| realtime     | schema_migrations          |
| realtime     | subscription               |
| storage      | buckets                    |
| storage      | buckets_analytics          |
| storage      | buckets_vectors            |
| storage      | migrations                 |
| storage      | objects                    |
| storage      | prefixes                   |
| storage      | s3_multipart_uploads       |
| storage      | s3_multipart_uploads_parts |
| storage      | vector_indexes             |
| vault        | secrets                    |


2) Columns for every table (run per table or adapt for all)


| table_schema | table_name           | column_name                  | ordinal_position | data_type                | is_nullable | column_default                             |
| ------------ | -------------------- | ---------------------------- | ---------------- | ------------------------ | ----------- | ------------------------------------------ |
| auth         | audit_log_entries    | instance_id                  | 1                | uuid                     | YES         | null                                       |
| auth         | audit_log_entries    | id                           | 2                | uuid                     | NO          | null                                       |
| auth         | audit_log_entries    | payload                      | 3                | json                     | YES         | null                                       |
| auth         | audit_log_entries    | created_at                   | 4                | timestamp with time zone | YES         | null                                       |
| auth         | audit_log_entries    | ip_address                   | 5                | character varying        | NO          | ''::character varying                      |
| auth         | flow_state           | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | flow_state           | user_id                      | 2                | uuid                     | YES         | null                                       |
| auth         | flow_state           | auth_code                    | 3                | text                     | NO          | null                                       |
| auth         | flow_state           | code_challenge_method        | 4                | USER-DEFINED             | NO          | null                                       |
| auth         | flow_state           | code_challenge               | 5                | text                     | NO          | null                                       |
| auth         | flow_state           | provider_type                | 6                | text                     | NO          | null                                       |
| auth         | flow_state           | provider_access_token        | 7                | text                     | YES         | null                                       |
| auth         | flow_state           | provider_refresh_token       | 8                | text                     | YES         | null                                       |
| auth         | flow_state           | created_at                   | 9                | timestamp with time zone | YES         | null                                       |
| auth         | flow_state           | updated_at                   | 10               | timestamp with time zone | YES         | null                                       |
| auth         | flow_state           | authentication_method        | 11               | text                     | NO          | null                                       |
| auth         | flow_state           | auth_code_issued_at          | 12               | timestamp with time zone | YES         | null                                       |
| auth         | identities           | provider_id                  | 1                | text                     | NO          | null                                       |
| auth         | identities           | user_id                      | 2                | uuid                     | NO          | null                                       |
| auth         | identities           | identity_data                | 3                | jsonb                    | NO          | null                                       |
| auth         | identities           | provider                     | 4                | text                     | NO          | null                                       |
| auth         | identities           | last_sign_in_at              | 5                | timestamp with time zone | YES         | null                                       |
| auth         | identities           | created_at                   | 6                | timestamp with time zone | YES         | null                                       |
| auth         | identities           | updated_at                   | 7                | timestamp with time zone | YES         | null                                       |
| auth         | identities           | email                        | 8                | text                     | YES         | null                                       |
| auth         | identities           | id                           | 9                | uuid                     | NO          | gen_random_uuid()                          |
| auth         | instances            | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | instances            | uuid                         | 2                | uuid                     | YES         | null                                       |
| auth         | instances            | raw_base_config              | 3                | text                     | YES         | null                                       |
| auth         | instances            | created_at                   | 4                | timestamp with time zone | YES         | null                                       |
| auth         | instances            | updated_at                   | 5                | timestamp with time zone | YES         | null                                       |
| auth         | mfa_amr_claims       | session_id                   | 1                | uuid                     | NO          | null                                       |
| auth         | mfa_amr_claims       | created_at                   | 2                | timestamp with time zone | NO          | null                                       |
| auth         | mfa_amr_claims       | updated_at                   | 3                | timestamp with time zone | NO          | null                                       |
| auth         | mfa_amr_claims       | authentication_method        | 4                | text                     | NO          | null                                       |
| auth         | mfa_amr_claims       | id                           | 5                | uuid                     | NO          | null                                       |
| auth         | mfa_challenges       | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | mfa_challenges       | factor_id                    | 2                | uuid                     | NO          | null                                       |
| auth         | mfa_challenges       | created_at                   | 3                | timestamp with time zone | NO          | null                                       |
| auth         | mfa_challenges       | verified_at                  | 4                | timestamp with time zone | YES         | null                                       |
| auth         | mfa_challenges       | ip_address                   | 5                | inet                     | NO          | null                                       |
| auth         | mfa_challenges       | otp_code                     | 6                | text                     | YES         | null                                       |
| auth         | mfa_challenges       | web_authn_session_data       | 7                | jsonb                    | YES         | null                                       |
| auth         | mfa_factors          | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | mfa_factors          | user_id                      | 2                | uuid                     | NO          | null                                       |
| auth         | mfa_factors          | friendly_name                | 3                | text                     | YES         | null                                       |
| auth         | mfa_factors          | factor_type                  | 4                | USER-DEFINED             | NO          | null                                       |
| auth         | mfa_factors          | status                       | 5                | USER-DEFINED             | NO          | null                                       |
| auth         | mfa_factors          | created_at                   | 6                | timestamp with time zone | NO          | null                                       |
| auth         | mfa_factors          | updated_at                   | 7                | timestamp with time zone | NO          | null                                       |
| auth         | mfa_factors          | secret                       | 8                | text                     | YES         | null                                       |
| auth         | mfa_factors          | phone                        | 9                | text                     | YES         | null                                       |
| auth         | mfa_factors          | last_challenged_at           | 10               | timestamp with time zone | YES         | null                                       |
| auth         | mfa_factors          | web_authn_credential         | 11               | jsonb                    | YES         | null                                       |
| auth         | mfa_factors          | web_authn_aaguid             | 12               | uuid                     | YES         | null                                       |
| auth         | mfa_factors          | last_webauthn_challenge_data | 13               | jsonb                    | YES         | null                                       |
| auth         | oauth_authorizations | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | oauth_authorizations | authorization_id             | 2                | text                     | NO          | null                                       |
| auth         | oauth_authorizations | client_id                    | 3                | uuid                     | NO          | null                                       |
| auth         | oauth_authorizations | user_id                      | 4                | uuid                     | YES         | null                                       |
| auth         | oauth_authorizations | redirect_uri                 | 5                | text                     | NO          | null                                       |
| auth         | oauth_authorizations | scope                        | 6                | text                     | NO          | null                                       |
| auth         | oauth_authorizations | state                        | 7                | text                     | YES         | null                                       |
| auth         | oauth_authorizations | resource                     | 8                | text                     | YES         | null                                       |
| auth         | oauth_authorizations | code_challenge               | 9                | text                     | YES         | null                                       |
| auth         | oauth_authorizations | code_challenge_method        | 10               | USER-DEFINED             | YES         | null                                       |
| auth         | oauth_authorizations | response_type                | 11               | USER-DEFINED             | NO          | 'code'::auth.oauth_response_type           |
| auth         | oauth_authorizations | status                       | 12               | USER-DEFINED             | NO          | 'pending'::auth.oauth_authorization_status |
| auth         | oauth_authorizations | authorization_code           | 13               | text                     | YES         | null                                       |
| auth         | oauth_authorizations | created_at                   | 14               | timestamp with time zone | NO          | now()                                      |
| auth         | oauth_authorizations | expires_at                   | 15               | timestamp with time zone | NO          | (now() + '00:03:00'::interval)             |
| auth         | oauth_authorizations | approved_at                  | 16               | timestamp with time zone | YES         | null                                       |
| auth         | oauth_authorizations | nonce                        | 17               | text                     | YES         | null                                       |
| auth         | oauth_client_states  | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | oauth_client_states  | provider_type                | 2                | text                     | NO          | null                                       |
| auth         | oauth_client_states  | code_verifier                | 3                | text                     | YES         | null                                       |
| auth         | oauth_client_states  | created_at                   | 4                | timestamp with time zone | NO          | null                                       |
| auth         | oauth_clients        | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | oauth_clients        | client_secret_hash           | 3                | text                     | YES         | null                                       |
| auth         | oauth_clients        | registration_type            | 4                | USER-DEFINED             | NO          | null                                       |
| auth         | oauth_clients        | redirect_uris                | 5                | text                     | NO          | null                                       |
| auth         | oauth_clients        | grant_types                  | 6                | text                     | NO          | null                                       |
| auth         | oauth_clients        | client_name                  | 7                | text                     | YES         | null                                       |
| auth         | oauth_clients        | client_uri                   | 8                | text                     | YES         | null                                       |
| auth         | oauth_clients        | logo_uri                     | 9                | text                     | YES         | null                                       |
| auth         | oauth_clients        | created_at                   | 10               | timestamp with time zone | NO          | now()                                      |
| auth         | oauth_clients        | updated_at                   | 11               | timestamp with time zone | NO          | now()                                      |
| auth         | oauth_clients        | deleted_at                   | 12               | timestamp with time zone | YES         | null                                       |
| auth         | oauth_clients        | client_type                  | 13               | USER-DEFINED             | NO          | 'confidential'::auth.oauth_client_type     |
| auth         | oauth_consents       | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | oauth_consents       | user_id                      | 2                | uuid                     | NO          | null                                       |
| auth         | oauth_consents       | client_id                    | 3                | uuid                     | NO          | null                                       |
| auth         | oauth_consents       | scopes                       | 4                | text                     | NO          | null                                       |
| auth         | oauth_consents       | granted_at                   | 5                | timestamp with time zone | NO          | now()                                      |
| auth         | oauth_consents       | revoked_at                   | 6                | timestamp with time zone | YES         | null                                       |
| auth         | one_time_tokens      | id                           | 1                | uuid                     | NO          | null                                       |
| auth         | one_time_tokens      | user_id                      | 2                | uuid                     | NO          | null                                       |
| auth         | one_time_tokens      | token_type                   | 3                | USER-DEFINED             | NO          | null                                       |
| auth         | one_time_tokens      | token_hash                   | 4                | text                     | NO          | null                                       |
| auth         | one_time_tokens      | relates_to                   | 5                | text                     | NO          | null                                       |


3) Foreign keys (relations)


| constraint_name                         | table_schema | table_name         | column_name        | foreign_table_schema | foreign_table_name | foreign_column_name |
| --------------------------------------- | ------------ | ------------------ | ------------------ | -------------------- | ------------------ | ------------------- |
| comments_media_asset_id_fkey            | public       | comments           | media_asset_id     | public               | media_assets       | id                  |
| comments_deliverable_id_fkey            | public       | comments           | deliverable_id     | public               | deliverables       | id                  |
| comments_parent_id_fkey                 | public       | comments           | parent_id          | public               | comments           | id                  |
| deliverable_assets_deliverable_id_fkey  | public       | deliverable_assets | deliverable_id     | public               | deliverables       | id                  |
| deliverable_assets_media_asset_id_fkey  | public       | deliverable_assets | media_asset_id     | public               | media_assets       | id                  |
| deliverables_project_id_fkey            | public       | deliverables       | project_id         | public               | projects           | id                  |
| hero_slots_mobile_image_id_fkey         | public       | hero_slots         | mobile_image_id    | public               | site_images        | id                  |
| hero_slots_image_id_fkey                | public       | hero_slots         | image_id           | public               | site_images        | id                  |
| media_owner_id_fkey                     | public       | media              | owner_id           | public               | profiles           | id                  |
| media_assets_project_id_fkey            | public       | media_assets       | project_id         | public               | projects           | id                  |
| portfolio_items_thumb_image_id_fkey     | public       | portfolio_items    | thumb_image_id     | public               | images             | id                  |
| portfolio_items_hover_image_id_fkey     | public       | portfolio_items    | hover_image_id     | public               | site_images        | id                  |
| portfolio_items_thumbnail_image_id_fkey | public       | portfolio_items    | thumbnail_image_id | public               | site_images        | id                  |
| portfolio_items_cover_image_id_fkey     | public       | portfolio_items    | cover_image_id     | public               | site_images        | id                  |
| portfolio_items_image_id_fkey           | public       | portfolio_items    | image_id           | public               | images             | id                  |
| project_clients_project_id_fkey         | public       | project_clients    | project_id         | public               | projects           | id                  |
| project_members_project_id_fkey         | public       | project_members    | project_id         | public               | projects           | id                  |


4) Indexes


| schemaname | tablename                  | indexname                                            | tablespace | indexdef                                                                                                                                                                    |
| ---------- | -------------------------- | ---------------------------------------------------- | ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auth       | audit_log_entries          | audit_logs_instance_id_idx                           | null       | CREATE INDEX audit_logs_instance_id_idx ON auth.audit_log_entries USING btree (instance_id)                                                                                 |
| auth       | audit_log_entries          | audit_log_entries_pkey                               | null       | CREATE UNIQUE INDEX audit_log_entries_pkey ON auth.audit_log_entries USING btree (id)                                                                                       |
| auth       | flow_state                 | flow_state_created_at_idx                            | null       | CREATE INDEX flow_state_created_at_idx ON auth.flow_state USING btree (created_at DESC)                                                                                     |
| auth       | flow_state                 | idx_user_id_auth_method                              | null       | CREATE INDEX idx_user_id_auth_method ON auth.flow_state USING btree (user_id, authentication_method)                                                                        |
| auth       | flow_state                 | idx_auth_code                                        | null       | CREATE INDEX idx_auth_code ON auth.flow_state USING btree (auth_code)                                                                                                       |
| auth       | flow_state                 | flow_state_pkey                                      | null       | CREATE UNIQUE INDEX flow_state_pkey ON auth.flow_state USING btree (id)                                                                                                     |
| auth       | identities                 | identities_pkey                                      | null       | CREATE UNIQUE INDEX identities_pkey ON auth.identities USING btree (id)                                                                                                     |
| auth       | identities                 | identities_user_id_idx                               | null       | CREATE INDEX identities_user_id_idx ON auth.identities USING btree (user_id)                                                                                                |
| auth       | identities                 | identities_email_idx                                 | null       | CREATE INDEX identities_email_idx ON auth.identities USING btree (email text_pattern_ops)                                                                                   |
| auth       | identities                 | identities_provider_id_provider_unique               | null       | CREATE UNIQUE INDEX identities_provider_id_provider_unique ON auth.identities USING btree (provider_id, provider)                                                           |
| auth       | instances                  | instances_pkey                                       | null       | CREATE UNIQUE INDEX instances_pkey ON auth.instances USING btree (id)                                                                                                       |
| auth       | mfa_amr_claims             | amr_id_pk                                            | null       | CREATE UNIQUE INDEX amr_id_pk ON auth.mfa_amr_claims USING btree (id)                                                                                                       |
| auth       | mfa_amr_claims             | mfa_amr_claims_session_id_authentication_method_pkey | null       | CREATE UNIQUE INDEX mfa_amr_claims_session_id_authentication_method_pkey ON auth.mfa_amr_claims USING btree (session_id, authentication_method)                             |
| auth       | mfa_challenges             | mfa_challenge_created_at_idx                         | null       | CREATE INDEX mfa_challenge_created_at_idx ON auth.mfa_challenges USING btree (created_at DESC)                                                                              |
| auth       | mfa_challenges             | mfa_challenges_pkey                                  | null       | CREATE UNIQUE INDEX mfa_challenges_pkey ON auth.mfa_challenges USING btree (id)                                                                                             |
| auth       | mfa_factors                | mfa_factors_user_friendly_name_unique                | null       | CREATE UNIQUE INDEX mfa_factors_user_friendly_name_unique ON auth.mfa_factors USING btree (friendly_name, user_id) WHERE (TRIM(BOTH FROM friendly_name) <> ''::text)        |
| auth       | mfa_factors                | mfa_factors_user_id_idx                              | null       | CREATE INDEX mfa_factors_user_id_idx ON auth.mfa_factors USING btree (user_id)                                                                                              |
| auth       | mfa_factors                | unique_phone_factor_per_user                         | null       | CREATE UNIQUE INDEX unique_phone_factor_per_user ON auth.mfa_factors USING btree (user_id, phone)                                                                           |
| auth       | mfa_factors                | mfa_factors_last_challenged_at_key                   | null       | CREATE UNIQUE INDEX mfa_factors_last_challenged_at_key ON auth.mfa_factors USING btree (last_challenged_at)                                                                 |
| auth       | mfa_factors                | factor_id_created_at_idx                             | null       | CREATE INDEX factor_id_created_at_idx ON auth.mfa_factors USING btree (user_id, created_at)                                                                                 |
| auth       | mfa_factors                | mfa_factors_pkey                                     | null       | CREATE UNIQUE INDEX mfa_factors_pkey ON auth.mfa_factors USING btree (id)                                                                                                   |
| auth       | oauth_authorizations       | oauth_authorizations_authorization_code_key          | null       | CREATE UNIQUE INDEX oauth_authorizations_authorization_code_key ON auth.oauth_authorizations USING btree (authorization_code)                                               |
| auth       | oauth_authorizations       | oauth_auth_pending_exp_idx                           | null       | CREATE INDEX oauth_auth_pending_exp_idx ON auth.oauth_authorizations USING btree (expires_at) WHERE (status = 'pending'::auth.oauth_authorization_status)                   |
| auth       | oauth_authorizations       | oauth_authorizations_pkey                            | null       | CREATE UNIQUE INDEX oauth_authorizations_pkey ON auth.oauth_authorizations USING btree (id)                                                                                 |
| auth       | oauth_authorizations       | oauth_authorizations_authorization_id_key            | null       | CREATE UNIQUE INDEX oauth_authorizations_authorization_id_key ON auth.oauth_authorizations USING btree (authorization_id)                                                   |
| auth       | oauth_client_states        | idx_oauth_client_states_created_at                   | null       | CREATE INDEX idx_oauth_client_states_created_at ON auth.oauth_client_states USING btree (created_at)                                                                        |
| auth       | oauth_client_states        | oauth_client_states_pkey                             | null       | CREATE UNIQUE INDEX oauth_client_states_pkey ON auth.oauth_client_states USING btree (id)                                                                                   |
| auth       | oauth_clients              | oauth_clients_deleted_at_idx                         | null       | CREATE INDEX oauth_clients_deleted_at_idx ON auth.oauth_clients USING btree (deleted_at)                                                                                    |
| auth       | oauth_clients              | oauth_clients_pkey                                   | null       | CREATE UNIQUE INDEX oauth_clients_pkey ON auth.oauth_clients USING btree (id)                                                                                               |
| auth       | oauth_consents             | oauth_consents_pkey                                  | null       | CREATE UNIQUE INDEX oauth_consents_pkey ON auth.oauth_consents USING btree (id)                                                                                             |
| auth       | oauth_consents             | oauth_consents_user_order_idx                        | null       | CREATE INDEX oauth_consents_user_order_idx ON auth.oauth_consents USING btree (user_id, granted_at DESC)                                                                    |
| auth       | oauth_consents             | oauth_consents_active_user_client_idx                | null       | CREATE INDEX oauth_consents_active_user_client_idx ON auth.oauth_consents USING btree (user_id, client_id) WHERE (revoked_at IS NULL)                                       |
| auth       | oauth_consents             | oauth_consents_active_client_idx                     | null       | CREATE INDEX oauth_consents_active_client_idx ON auth.oauth_consents USING btree (client_id) WHERE (revoked_at IS NULL)                                                     |
| auth       | oauth_consents             | oauth_consents_user_client_unique                    | null       | CREATE UNIQUE INDEX oauth_consents_user_client_unique ON auth.oauth_consents USING btree (user_id, client_id)                                                               |
| auth       | one_time_tokens            | one_time_tokens_user_id_token_type_key               | null       | CREATE UNIQUE INDEX one_time_tokens_user_id_token_type_key ON auth.one_time_tokens USING btree (user_id, token_type)                                                        |
| auth       | one_time_tokens            | one_time_tokens_token_hash_hash_idx                  | null       | CREATE INDEX one_time_tokens_token_hash_hash_idx ON auth.one_time_tokens USING hash (token_hash)                                                                            |
| auth       | one_time_tokens            | one_time_tokens_relates_to_hash_idx                  | null       | CREATE INDEX one_time_tokens_relates_to_hash_idx ON auth.one_time_tokens USING hash (relates_to)                                                                            |
| auth       | one_time_tokens            | one_time_tokens_pkey                                 | null       | CREATE UNIQUE INDEX one_time_tokens_pkey ON auth.one_time_tokens USING btree (id)                                                                                           |
| auth       | refresh_tokens             | refresh_tokens_instance_id_user_id_idx               | null       | CREATE INDEX refresh_tokens_instance_id_user_id_idx ON auth.refresh_tokens USING btree (instance_id, user_id)                                                               |
| auth       | refresh_tokens             | refresh_tokens_instance_id_idx                       | null       | CREATE INDEX refresh_tokens_instance_id_idx ON auth.refresh_tokens USING btree (instance_id)                                                                                |
| auth       | refresh_tokens             | refresh_tokens_pkey                                  | null       | CREATE UNIQUE INDEX refresh_tokens_pkey ON auth.refresh_tokens USING btree (id)                                                                                             |
| auth       | refresh_tokens             | refresh_tokens_parent_idx                            | null       | CREATE INDEX refresh_tokens_parent_idx ON auth.refresh_tokens USING btree (parent)                                                                                          |
| auth       | refresh_tokens             | refresh_tokens_token_unique                          | null       | CREATE UNIQUE INDEX refresh_tokens_token_unique ON auth.refresh_tokens USING btree (token)                                                                                  |
| auth       | refresh_tokens             | refresh_tokens_session_id_revoked_idx                | null       | CREATE INDEX refresh_tokens_session_id_revoked_idx ON auth.refresh_tokens USING btree (session_id, revoked)                                                                 |
| auth       | refresh_tokens             | refresh_tokens_updated_at_idx                        | null       | CREATE INDEX refresh_tokens_updated_at_idx ON auth.refresh_tokens USING btree (updated_at DESC)                                                                             |
| auth       | saml_providers             | saml_providers_entity_id_key                         | null       | CREATE UNIQUE INDEX saml_providers_entity_id_key ON auth.saml_providers USING btree (entity_id)                                                                             |
| auth       | saml_providers             | saml_providers_sso_provider_id_idx                   | null       | CREATE INDEX saml_providers_sso_provider_id_idx ON auth.saml_providers USING btree (sso_provider_id)                                                                        |
| auth       | saml_providers             | saml_providers_pkey                                  | null       | CREATE UNIQUE INDEX saml_providers_pkey ON auth.saml_providers USING btree (id)                                                                                             |
| auth       | saml_relay_states          | saml_relay_states_sso_provider_id_idx                | null       | CREATE INDEX saml_relay_states_sso_provider_id_idx ON auth.saml_relay_states USING btree (sso_provider_id)                                                                  |
| auth       | saml_relay_states          | saml_relay_states_for_email_idx                      | null       | CREATE INDEX saml_relay_states_for_email_idx ON auth.saml_relay_states USING btree (for_email)                                                                              |
| auth       | saml_relay_states          | saml_relay_states_created_at_idx                     | null       | CREATE INDEX saml_relay_states_created_at_idx ON auth.saml_relay_states USING btree (created_at DESC)                                                                       |
| auth       | saml_relay_states          | saml_relay_states_pkey                               | null       | CREATE UNIQUE INDEX saml_relay_states_pkey ON auth.saml_relay_states USING btree (id)                                                                                       |
| auth       | schema_migrations          | schema_migrations_pkey                               | null       | CREATE UNIQUE INDEX schema_migrations_pkey ON auth.schema_migrations USING btree (version)                                                                                  |
| auth       | sessions                   | sessions_oauth_client_id_idx                         | null       | CREATE INDEX sessions_oauth_client_id_idx ON auth.sessions USING btree (oauth_client_id)                                                                                    |
| auth       | sessions                   | user_id_created_at_idx                               | null       | CREATE INDEX user_id_created_at_idx ON auth.sessions USING btree (user_id, created_at)                                                                                      |
| auth       | sessions                   | sessions_user_id_idx                                 | null       | CREATE INDEX sessions_user_id_idx ON auth.sessions USING btree (user_id)                                                                                                    |
| auth       | sessions                   | sessions_pkey                                        | null       | CREATE UNIQUE INDEX sessions_pkey ON auth.sessions USING btree (id)                                                                                                         |
| auth       | sessions                   | sessions_not_after_idx                               | null       | CREATE INDEX sessions_not_after_idx ON auth.sessions USING btree (not_after DESC)                                                                                           |
| auth       | sso_domains                | sso_domains_sso_provider_id_idx                      | null       | CREATE INDEX sso_domains_sso_provider_id_idx ON auth.sso_domains USING btree (sso_provider_id)                                                                              |
| auth       | sso_domains                | sso_domains_domain_idx                               | null       | CREATE UNIQUE INDEX sso_domains_domain_idx ON auth.sso_domains USING btree (lower(domain))                                                                                  |
| auth       | sso_domains                | sso_domains_pkey                                     | null       | CREATE UNIQUE INDEX sso_domains_pkey ON auth.sso_domains USING btree (id)                                                                                                   |
| auth       | sso_providers              | sso_providers_resource_id_idx                        | null       | CREATE UNIQUE INDEX sso_providers_resource_id_idx ON auth.sso_providers USING btree (lower(resource_id))                                                                    |
| auth       | sso_providers              | sso_providers_resource_id_pattern_idx                | null       | CREATE INDEX sso_providers_resource_id_pattern_idx ON auth.sso_providers USING btree (resource_id text_pattern_ops)                                                         |
| auth       | sso_providers              | sso_providers_pkey                                   | null       | CREATE UNIQUE INDEX sso_providers_pkey ON auth.sso_providers USING btree (id)                                                                                               |
| auth       | users                      | users_pkey                                           | null       | CREATE UNIQUE INDEX users_pkey ON auth.users USING btree (id)                                                                                                               |
| auth       | users                      | users_instance_id_idx                                | null       | CREATE INDEX users_instance_id_idx ON auth.users USING btree (instance_id)                                                                                                  |
| auth       | users                      | users_instance_id_email_idx                          | null       | CREATE INDEX users_instance_id_email_idx ON auth.users USING btree (instance_id, lower((email)::text))                                                                      |
| auth       | users                      | confirmation_token_idx                               | null       | CREATE UNIQUE INDEX confirmation_token_idx ON auth.users USING btree (confirmation_token) WHERE ((confirmation_token)::text !~ '^[0-9 ]*$'::text)                           |
| auth       | users                      | recovery_token_idx                                   | null       | CREATE UNIQUE INDEX recovery_token_idx ON auth.users USING btree (recovery_token) WHERE ((recovery_token)::text !~ '^[0-9 ]*$'::text)                                       |
| auth       | users                      | email_change_token_current_idx                       | null       | CREATE UNIQUE INDEX email_change_token_current_idx ON auth.users USING btree (email_change_token_current) WHERE ((email_change_token_current)::text !~ '^[0-9 ]*$'::text)   |
| auth       | users                      | email_change_token_new_idx                           | null       | CREATE UNIQUE INDEX email_change_token_new_idx ON auth.users USING btree (email_change_token_new) WHERE ((email_change_token_new)::text !~ '^[0-9 ]*$'::text)               |
| auth       | users                      | reauthentication_token_idx                           | null       | CREATE UNIQUE INDEX reauthentication_token_idx ON auth.users USING btree (reauthentication_token) WHERE ((reauthentication_token)::text !~ '^[0-9 ]*$'::text)               |
| auth       | users                      | users_email_partial_key                              | null       | CREATE UNIQUE INDEX users_email_partial_key ON auth.users USING btree (email) WHERE (is_sso_user = false)                                                                   |
| auth       | users                      | users_phone_key                                      | null       | CREATE UNIQUE INDEX users_phone_key ON auth.users USING btree (phone)                                                                                                       |
| auth       | users                      | users_is_anonymous_idx                               | null       | CREATE INDEX users_is_anonymous_idx ON auth.users USING btree (is_anonymous)                                                                                                |
| public     | comments                   | idx_comments_asset                                   | null       | CREATE INDEX idx_comments_asset ON public.comments USING btree (media_asset_id)                                                                                             |
| public     | comments                   | comments_pkey                                        | null       | CREATE UNIQUE INDEX comments_pkey ON public.comments USING btree (id)                                                                                                       |
| public     | comments                   | idx_comments_deliverable                             | null       | CREATE INDEX idx_comments_deliverable ON public.comments USING btree (deliverable_id)                                                                                       |
| public     | comments                   | idx_comments_parent                                  | null       | CREATE INDEX idx_comments_parent ON public.comments USING btree (parent_id)                                                                                                 |
| public     | comments                   | idx_comments_user                                    | null       | CREATE INDEX idx_comments_user ON public.comments USING btree (user_id)                                                                                                     |
| public     | deliverable_assets         | idx_deliverable_assets_deliverable                   | null       | CREATE INDEX idx_deliverable_assets_deliverable ON public.deliverable_assets USING btree (deliverable_id)                                                                   |
| public     | deliverable_assets         | deliverable_assets_pkey                              | null       | CREATE UNIQUE INDEX deliverable_assets_pkey ON public.deliverable_assets USING btree (id)                                                                                   |
| public     | deliverable_assets         | idx_deliverable_assets_asset                         | null       | CREATE INDEX idx_deliverable_assets_asset ON public.deliverable_assets USING btree (media_asset_id)                                                                         |
| public     | deliverable_assets         | deliverable_assets_deliverable_id_media_asset_id_key | null       | CREATE UNIQUE INDEX deliverable_assets_deliverable_id_media_asset_id_key ON public.deliverable_assets USING btree (deliverable_id, media_asset_id)                          |
| public     | deliverables               | idx_deliverables_status                              | null       | CREATE INDEX idx_deliverables_status ON public.deliverables USING btree (status)                                                                                            |
| public     | deliverables               | deliverables_pkey                                    | null       | CREATE UNIQUE INDEX deliverables_pkey ON public.deliverables USING btree (id)                                                                                               |
| public     | deliverables               | idx_deliverables_project                             | null       | CREATE INDEX idx_deliverables_project ON public.deliverables USING btree (project_id)                                                                                       |
| public     | deliverables               | idx_deliverables_due_date                            | null       | CREATE INDEX idx_deliverables_due_date ON public.deliverables USING btree (due_date)                                                                                        |
| public     | hero_slots                 | hero_slots_pkey                                      | null       | CREATE UNIQUE INDEX hero_slots_pkey ON public.hero_slots USING btree (id)                                                                                                   |
| public     | hero_slots                 | hero_slots_page_key_slot_key_key                     | null       | CREATE UNIQUE INDEX hero_slots_page_key_slot_key_key ON public.hero_slots USING btree (page_key, slot_key)                                                                  |
| public     | images                     | images_pkey                                          | null       | CREATE UNIQUE INDEX images_pkey ON public.images USING btree (id)                                                                                                           |
| public     | media                      | media_pkey                                           | null       | CREATE UNIQUE INDEX media_pkey ON public.media USING btree (id)                                                                                                             |
| public     | media_assets               | idx_media_assets_thumbnail                           | null       | CREATE INDEX idx_media_assets_thumbnail ON public.media_assets USING btree (thumbnail_path) WHERE (thumbnail_path IS NOT NULL)                                              |
| public     | media_assets               | idx_media_assets_tags                                | null       | CREATE INDEX idx_media_assets_tags ON public.media_assets USING gin (tags)                                                                                                  |
| public     | media_assets               | media_assets_pkey                                    | null       | CREATE UNIQUE INDEX media_assets_pkey ON public.media_assets USING btree (id)                                                                                               |
| public     | media_assets               | idx_media_assets_status                              | null       | CREATE INDEX idx_media_assets_status ON public.media_assets USING btree (status)                                                                                            |
| public     | notifications              | idx_notifications_unread                             | null       | CREATE INDEX idx_notifications_unread ON public.notifications USING btree (user_id, read_at) WHERE (read_at IS NULL)                                                        |
| public     | notifications              | idx_notifications_created                            | null       | CREATE INDEX idx_notifications_created ON public.notifications USING btree (created_at DESC)                                                                                |
| public     | notifications              | notifications_pkey                                   | null       | CREATE UNIQUE INDEX notifications_pkey ON public.notifications USING btree (id)                                                                                             |
| public     | notifications              | idx_notifications_user                               | null       | CREATE INDEX idx_notifications_user ON public.notifications USING btree (user_id)                                                                                           |
| public     | notifications              | idx_notifications_type                               | null       | CREATE INDEX idx_notifications_type ON public.notifications USING btree (type)                                                                                              |
| public     | portfolio_items            | idx_portfolio_categories                             | null       | CREATE INDEX idx_portfolio_categories ON public.portfolio_items USING gin (categories)                                                                                      |
| public     | portfolio_items            | idx_portfolio_published                              | null       | CREATE INDEX idx_portfolio_published ON public.portfolio_items USING btree (is_published) WHERE (is_published = true)                                                       |
| public     | portfolio_items            | idx_portfolio_sort                                   | null       | CREATE INDEX idx_portfolio_sort ON public.portfolio_items USING btree (sort_order)                                                                                          |
| public     | portfolio_items            | portfolio_items_pkey                                 | null       | CREATE UNIQUE INDEX portfolio_items_pkey ON public.portfolio_items USING btree (id)                                                                                         |
| public     | portfolio_items            | portfolio_items_slug_key                             | null       | CREATE UNIQUE INDEX portfolio_items_slug_key ON public.portfolio_items USING btree (slug)                                                                                   |
| public     | portfolio_items            | idx_portfolio_featured                               | null       | CREATE INDEX idx_portfolio_featured ON public.portfolio_items USING btree (is_featured) WHERE (is_featured = true)                                                          |
| public     | profiles                   | profiles_email_key                                   | null       | CREATE UNIQUE INDEX profiles_email_key ON public.profiles USING btree (email)                                                                                               |
| public     | profiles                   | profiles_pkey                                        | null       | CREATE UNIQUE INDEX profiles_pkey ON public.profiles USING btree (id)                                                                                                       |
| public     | project_clients            | project_clients_pkey                                 | null       | CREATE UNIQUE INDEX project_clients_pkey ON public.project_clients USING btree (id)                                                                                         |
| public     | project_clients            | idx_project_clients_user                             | null       | CREATE INDEX idx_project_clients_user ON public.project_clients USING btree (user_id)                                                                                       |
| public     | project_clients            | idx_project_clients_project                          | null       | CREATE INDEX idx_project_clients_project ON public.project_clients USING btree (project_id)                                                                                 |
| public     | project_clients            | project_clients_project_id_user_id_key               | null       | CREATE UNIQUE INDEX project_clients_project_id_user_id_key ON public.project_clients USING btree (project_id, user_id)                                                      |
| public     | project_members            | project_members_pkey                                 | null       | CREATE UNIQUE INDEX project_members_pkey ON public.project_members USING btree (project_id, user_id)                                                                        |
| public     | projects                   | projects_pkey                                        | null       | CREATE UNIQUE INDEX projects_pkey ON public.projects USING btree (id)                                                                                                       |
| public     | site_images                | site_images_pkey                                     | null       | CREATE UNIQUE INDEX site_images_pkey ON public.site_images USING btree (id)                                                                                                 |
| realtime   | messages                   | messages_inserted_at_topic_index                     | null       | CREATE INDEX messages_inserted_at_topic_index ON ONLY realtime.messages USING btree (inserted_at DESC, topic) WHERE ((extension = 'broadcast'::text) AND (private IS TRUE)) |
| realtime   | messages                   | messages_pkey                                        | null       | CREATE UNIQUE INDEX messages_pkey ON ONLY realtime.messages USING btree (id, inserted_at)                                                                                   |
| realtime   | schema_migrations          | schema_migrations_pkey                               | null       | CREATE UNIQUE INDEX schema_migrations_pkey ON realtime.schema_migrations USING btree (version)                                                                              |
| realtime   | subscription               | pk_subscription                                      | null       | CREATE UNIQUE INDEX pk_subscription ON realtime.subscription USING btree (id)                                                                                               |
| realtime   | subscription               | ix_realtime_subscription_entity                      | null       | CREATE INDEX ix_realtime_subscription_entity ON realtime.subscription USING btree (entity)                                                                                  |
| realtime   | subscription               | subscription_subscription_id_entity_filters_key      | null       | CREATE UNIQUE INDEX subscription_subscription_id_entity_filters_key ON realtime.subscription USING btree (subscription_id, entity, filters)                                 |
| storage    | buckets                    | bname                                                | null       | CREATE UNIQUE INDEX bname ON storage.buckets USING btree (name)                                                                                                             |
| storage    | buckets                    | buckets_pkey                                         | null       | CREATE UNIQUE INDEX buckets_pkey ON storage.buckets USING btree (id)                                                                                                        |
| storage    | buckets_analytics          | buckets_analytics_pkey                               | null       | CREATE UNIQUE INDEX buckets_analytics_pkey ON storage.buckets_analytics USING btree (id)                                                                                    |
| storage    | buckets_analytics          | buckets_analytics_unique_name_idx                    | null       | CREATE UNIQUE INDEX buckets_analytics_unique_name_idx ON storage.buckets_analytics USING btree (name) WHERE (deleted_at IS NULL)                                            |
| storage    | buckets_vectors            | buckets_vectors_pkey                                 | null       | CREATE UNIQUE INDEX buckets_vectors_pkey ON storage.buckets_vectors USING btree (id)                                                                                        |
| storage    | migrations                 | migrations_name_key                                  | null       | CREATE UNIQUE INDEX migrations_name_key ON storage.migrations USING btree (name)                                                                                            |
| storage    | migrations                 | migrations_pkey                                      | null       | CREATE UNIQUE INDEX migrations_pkey ON storage.migrations USING btree (id)                                                                                                  |
| storage    | objects                    | idx_name_bucket_level_unique                         | null       | CREATE UNIQUE INDEX idx_name_bucket_level_unique ON storage.objects USING btree (name COLLATE "C", bucket_id, level)                                                        |
| storage    | objects                    | idx_objects_bucket_id_name                           | null       | CREATE INDEX idx_objects_bucket_id_name ON storage.objects USING btree (bucket_id, name COLLATE "C")                                                                        |
| storage    | objects                    | objects_bucket_id_level_idx                          | null       | CREATE UNIQUE INDEX objects_bucket_id_level_idx ON storage.objects USING btree (bucket_id, level, name COLLATE "C")                                                         |
| storage    | objects                    | idx_objects_lower_name                               | null       | CREATE INDEX idx_objects_lower_name ON storage.objects USING btree ((path_tokens[level]), lower(name) text_pattern_ops, bucket_id, level)                                   |
| storage    | objects                    | objects_pkey                                         | null       | CREATE UNIQUE INDEX objects_pkey ON storage.objects USING btree (id)                                                                                                        |
| storage    | objects                    | bucketid_objname                                     | null       | CREATE UNIQUE INDEX bucketid_objname ON storage.objects USING btree (bucket_id, name)                                                                                       |
| storage    | objects                    | name_prefix_search                                   | null       | CREATE INDEX name_prefix_search ON storage.objects USING btree (name text_pattern_ops)                                                                                      |
| storage    | prefixes                   | prefixes_pkey                                        | null       | CREATE UNIQUE INDEX prefixes_pkey ON storage.prefixes USING btree (bucket_id, level, name)                                                                                  |
| storage    | prefixes                   | idx_prefixes_lower_name                              | null       | CREATE INDEX idx_prefixes_lower_name ON storage.prefixes USING btree (bucket_id, level, ((string_to_array(name, '/'::text))[level]), lower(name) text_pattern_ops)          |
| storage    | s3_multipart_uploads       | s3_multipart_uploads_pkey                            | null       | CREATE UNIQUE INDEX s3_multipart_uploads_pkey ON storage.s3_multipart_uploads USING btree (id)                                                                              |
| storage    | s3_multipart_uploads       | idx_multipart_uploads_list                           | null       | CREATE INDEX idx_multipart_uploads_list ON storage.s3_multipart_uploads USING btree (bucket_id, key, created_at)                                                            |
| storage    | s3_multipart_uploads_parts | s3_multipart_uploads_parts_pkey                      | null       | CREATE UNIQUE INDEX s3_multipart_uploads_parts_pkey ON storage.s3_multipart_uploads_parts USING btree (id)                                                                  |
| storage    | vector_indexes             | vector_indexes_pkey                                  | null       | CREATE UNIQUE INDEX vector_indexes_pkey ON storage.vector_indexes USING btree (id)                                                                                          |
| storage    | vector_indexes             | vector_indexes_name_bucket_id_idx                    | null       | CREATE UNIQUE INDEX vector_indexes_name_bucket_id_idx ON storage.vector_indexes USING btree (name, bucket_id)                                                               |
| vault      | secrets                    | secrets_pkey                                         | null       | CREATE UNIQUE INDEX secrets_pkey ON vault.secrets USING btree (id)                                                                                                          |
| vault      | secrets                    | secrets_name_idx                                     | null       | CREATE UNIQUE INDEX secrets_name_idx ON vault.secrets USING btree (name) WHERE (name IS NOT NULL)                                                                           |


5) Triggers


| table_schema | table_name   | trigger_name                       | action_timing | event_manipulation |
| ------------ | ------------ | ---------------------------------- | ------------- | ------------------ |
| auth         | users        | on_auth_user_created               | AFTER         | INSERT             |
| public       | comments     | update_comments_updated_at         | BEFORE        | UPDATE             |
| public       | comments     | on_new_comment                     | AFTER         | INSERT             |
| public       | deliverables | update_deliverables_updated_at     | BEFORE        | UPDATE             |
| public       | deliverables | on_deliverable_status_change       | AFTER         | UPDATE             |
| public       | deliverables | on_deliverable_status_change       | AFTER         | INSERT             |
| realtime     | subscription | tr_check_filters                   | BEFORE        | INSERT             |
| realtime     | subscription | tr_check_filters                   | BEFORE        | UPDATE             |
| storage      | buckets      | enforce_bucket_name_length_trigger | BEFORE        | INSERT             |
| storage      | buckets      | enforce_bucket_name_length_trigger | BEFORE        | UPDATE             |
| storage      | objects      | objects_delete_delete_prefix       | AFTER         | DELETE             |
| storage      | objects      | objects_insert_create_prefix       | BEFORE        | INSERT             |
| storage      | objects      | update_objects_updated_at          | BEFORE        | UPDATE             |
| storage      | objects      | objects_update_create_prefix       | BEFORE        | UPDATE             |
| storage      | prefixes     | prefixes_create_hierarchy          | BEFORE        | INSERT             |
| storage      | prefixes     | prefixes_delete_hierarchy          | AFTER         | DELETE             |


6) Functions (stored procs)


| specific_schema | routine_name                          | routine_type |
| --------------- | ------------------------------------- | ------------ |
| auth            | email                                 | FUNCTION     |
| auth            | jwt                                   | FUNCTION     |
| auth            | role                                  | FUNCTION     |
| auth            | uid                                   | FUNCTION     |
| extensions      | armor                                 | FUNCTION     |
| extensions      | armor                                 | FUNCTION     |
| extensions      | crypt                                 | FUNCTION     |
| extensions      | dearmor                               | FUNCTION     |
| extensions      | decrypt                               | FUNCTION     |
| extensions      | decrypt_iv                            | FUNCTION     |
| extensions      | digest                                | FUNCTION     |
| extensions      | digest                                | FUNCTION     |
| extensions      | encrypt                               | FUNCTION     |
| extensions      | encrypt_iv                            | FUNCTION     |
| extensions      | gen_random_bytes                      | FUNCTION     |
| extensions      | gen_random_uuid                       | FUNCTION     |
| extensions      | gen_salt                              | FUNCTION     |
| extensions      | gen_salt                              | FUNCTION     |
| extensions      | grant_pg_cron_access                  | FUNCTION     |
| extensions      | grant_pg_graphql_access               | FUNCTION     |
| extensions      | grant_pg_net_access                   | FUNCTION     |
| extensions      | hmac                                  | FUNCTION     |
| extensions      | hmac                                  | FUNCTION     |
| extensions      | pg_stat_statements                    | FUNCTION     |
| extensions      | pg_stat_statements_info               | FUNCTION     |
| extensions      | pg_stat_statements_reset              | FUNCTION     |
| extensions      | pgp_armor_headers                     | FUNCTION     |
| extensions      | pgp_key_id                            | FUNCTION     |
| extensions      | pgp_pub_decrypt                       | FUNCTION     |
| extensions      | pgp_pub_decrypt                       | FUNCTION     |
| extensions      | pgp_pub_decrypt                       | FUNCTION     |
| extensions      | pgp_pub_decrypt_bytea                 | FUNCTION     |
| extensions      | pgp_pub_decrypt_bytea                 | FUNCTION     |
| extensions      | pgp_pub_decrypt_bytea                 | FUNCTION     |
| extensions      | pgp_pub_encrypt                       | FUNCTION     |
| extensions      | pgp_pub_encrypt                       | FUNCTION     |
| extensions      | pgp_pub_encrypt_bytea                 | FUNCTION     |
| extensions      | pgp_pub_encrypt_bytea                 | FUNCTION     |
| extensions      | pgp_sym_decrypt                       | FUNCTION     |
| extensions      | pgp_sym_decrypt                       | FUNCTION     |
| extensions      | pgp_sym_decrypt_bytea                 | FUNCTION     |
| extensions      | pgp_sym_decrypt_bytea                 | FUNCTION     |
| extensions      | pgp_sym_encrypt                       | FUNCTION     |
| extensions      | pgp_sym_encrypt                       | FUNCTION     |
| extensions      | pgp_sym_encrypt_bytea                 | FUNCTION     |
| extensions      | pgp_sym_encrypt_bytea                 | FUNCTION     |
| extensions      | pgrst_ddl_watch                       | FUNCTION     |
| extensions      | pgrst_drop_watch                      | FUNCTION     |
| extensions      | set_graphql_placeholder               | FUNCTION     |
| extensions      | uuid_generate_v1                      | FUNCTION     |
| extensions      | uuid_generate_v1mc                    | FUNCTION     |
| extensions      | uuid_generate_v3                      | FUNCTION     |
| extensions      | uuid_generate_v4                      | FUNCTION     |
| extensions      | uuid_generate_v5                      | FUNCTION     |
| extensions      | uuid_nil                              | FUNCTION     |
| extensions      | uuid_ns_dns                           | FUNCTION     |
| extensions      | uuid_ns_oid                           | FUNCTION     |
| extensions      | uuid_ns_url                           | FUNCTION     |
| extensions      | uuid_ns_x500                          | FUNCTION     |
| graphql         | _internal_resolve                     | FUNCTION     |
| graphql         | comment_directive                     | FUNCTION     |
| graphql         | exception                             | FUNCTION     |
| graphql         | get_schema_version                    | FUNCTION     |
| graphql         | increment_schema_version              | FUNCTION     |
| graphql         | resolve                               | FUNCTION     |
| graphql_public  | graphql                               | FUNCTION     |
| public          | handle_new_user                       | FUNCTION     |
| public          | notify_deliverable_change             | FUNCTION     |
| public          | notify_new_comment                    | FUNCTION     |
| public          | update_updated_at_column              | FUNCTION     |
| realtime        | apply_rls                             | FUNCTION     |
| realtime        | broadcast_changes                     | FUNCTION     |
| realtime        | build_prepared_statement_sql          | FUNCTION     |
| realtime        | cast                                  | FUNCTION     |
| realtime        | check_equality_op                     | FUNCTION     |
| realtime        | is_visible_through_filters            | FUNCTION     |
| realtime        | list_changes                          | FUNCTION     |
| realtime        | quote_wal2json                        | FUNCTION     |
| realtime        | send                                  | FUNCTION     |
| realtime        | subscription_check_filters            | FUNCTION     |
| realtime        | to_regrole                            | FUNCTION     |
| realtime        | topic                                 | FUNCTION     |
| storage         | add_prefixes                          | FUNCTION     |
| storage         | can_insert_object                     | FUNCTION     |
| storage         | delete_leaf_prefixes                  | FUNCTION     |
| storage         | delete_prefix                         | FUNCTION     |
| storage         | delete_prefix_hierarchy_trigger       | FUNCTION     |
| storage         | enforce_bucket_name_length            | FUNCTION     |
| storage         | extension                             | FUNCTION     |
| storage         | filename                              | FUNCTION     |
| storage         | foldername                            | FUNCTION     |
| storage         | get_level                             | FUNCTION     |
| storage         | get_prefix                            | FUNCTION     |
| storage         | get_prefixes                          | FUNCTION     |
| storage         | get_size_by_bucket                    | FUNCTION     |
| storage         | list_multipart_uploads_with_delimiter | FUNCTION     |
| storage         | list_objects_with_delimiter           | FUNCTION     |
| storage         | lock_top_prefixes                     | FUNCTION     |
| storage         | objects_delete_cleanup                | FUNCTION     |
| storage         | objects_insert_prefix_trigger         | FUNCTION     |


7) Sequences


| sequence_schema | sequence_name         |
| --------------- | --------------------- |
| auth            | refresh_tokens_id_seq |
| graphql         | seq_schema_version    |


Row-Level Security (RLS) / Policies


| schemaname | tablename          | policyname                                      | cmd | using_expression                                                                                                                                                                                                                                                                                                                                                                                                              | with_check_expression                                                                                                                                                                                                                                                                                                                                                                           | roles |
| ---------- | ------------------ | ----------------------------------------------- | --- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----- |
| public     | comments           | Clients can view comments on their deliverables | r   | (((deliverable_id IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM (deliverables d
     JOIN projects p ON ((p.id = d.project_id)))
  WHERE ((p.client_id = auth.uid()) AND (d.id = comments.deliverable_id))))) OR ((media_asset_id IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM (media_assets ma
     JOIN projects p ON ((p.id = ma.project_id)))
  WHERE ((p.client_id = auth.uid()) AND (ma.id = comments.media_asset_id)))))) | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | comments           | Team can view all comments                      | r   | (EXISTS ( SELECT 1
   FROM (project_members pm
     JOIN deliverables d ON ((d.project_id = pm.project_id)))
  WHERE ((pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])) AND ((comments.deliverable_id = d.id) OR (comments.media_asset_id IS NOT NULL)))))                                                                                                                                   | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | deliverable_assets | Clients can view own deliverable assets         | r   | (EXISTS ( SELECT 1
   FROM (deliverables d
     JOIN project_clients pc ON ((pc.project_id = d.project_id)))
  WHERE ((d.id = deliverable_assets.deliverable_id) AND (pc.user_id = auth.uid()))))                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | deliverable_assets | Team can manage deliverable assets              | *   | (EXISTS ( SELECT 1
   FROM (project_members pm
     JOIN deliverables d ON ((d.project_id = pm.project_id)))
  WHERE ((d.id = deliverable_assets.deliverable_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | deliverables       | Clients can update own deliverable status       | w   | (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = deliverables.project_id) AND (p.client_id = auth.uid()))))                                                                                                                                                                                                                                                                                                             | (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = deliverables.project_id) AND (p.client_id = auth.uid()))))                                                                                                                                                                                                                                                                               | [0]   |
| public     | deliverables       | Clients can view own project deliverables       | r   | (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = deliverables.project_id) AND (p.client_id = auth.uid()))))                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | deliverables       | Team can manage deliverables                    | *   | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = deliverables.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | images             | images_admin_write                              | *   | (auth.role() = 'admin'::text)                                                                                                                                                                                                                                                                                                                                                                                                 | (auth.role() = 'admin'::text)                                                                                                                                                                                                                                                                                                                                                                   | [0]   |
| public     | media              | owners can delete media                         | d   | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media              | owners can insert media                         | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                         | [0]   |
| public     | media              | owners can select media                         | r   | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media              | owners can update media                         | w   | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media              | public media read                               | r   | (visibility = 'public'::text)                                                                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media_assets       | Clients can view own project media              | r   | ((EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = media_assets.project_id) AND (p.client_id = auth.uid())))) OR (EXISTS ( SELECT 1
   FROM project_clients pc
  WHERE ((pc.user_id = auth.uid()) AND (pc.project_id = media_assets.project_id)))))                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media_assets       | Users can insert media                          | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = uploaded_by)                                                                                                                                                                                                                                                                                                                                                                      | [0]   |
| public     | media_assets       | project members can view media                  | r   | (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media_assets       | team and admins can upload media                | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()) AND (project_members.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                  | [0]   |
| public     | media_assets       | uploaders or admins can delete media            | d   | ((uploaded_by = auth.uid()) OR (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()) AND (project_members.role = 'admin'::text)))))                                                                                                                                                                                           | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media_assets       | uploaders or admins can update media            | w   | ((uploaded_by = auth.uid()) OR (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()) AND (project_members.role = 'admin'::text)))))                                                                                                                                                                                           | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | media_assets       | users can upload unassigned media               | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | ((project_id IS NULL) AND (auth.uid() = uploaded_by))                                                                                                                                                                                                                                                                                                                                           | [0]   |
| public     | notifications      | Team or project client can insert notifications | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | ((EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = ((notifications.payload ->> 'project_id'::text))::uuid) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text]))))) OR (EXISTS ( SELECT 1
   FROM project_clients pc
  WHERE ((pc.project_id = ((notifications.payload ->> 'project_id'::text))::uuid) AND (pc.user_id = auth.uid()))))) | [0]   |
| public     | notifications      | Users can update own notifications              | w   | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | notifications      | Users can view own notifications                | r   | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | profiles           | users can manage own profile                    | *   | (auth.uid() = id)                                                                                                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | project_clients    | Clients can view their project_clients          | r   | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | project_clients    | Team can manage project_clients                 | *   | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_clients.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                                                 | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_clients.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                   | [0]   |
| public     | project_members    | admins and team can manage project members      | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_members.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                   | [0]   |
| public     | project_members    | users can view their project memberships        | r   | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| public     | projects           | members can create projects                     | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() IS NOT NULL)                                                                                                                                                                                                                                                                                                                                                                        | [0]   |
| public     | projects           | members can view projects                       | r   | (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = projects.id) AND (project_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| storage    | objects            | project members can read files                  | r   | ((bucket_id = 'media'::text) AND (auth.uid() IS NOT NULL))                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                            | [0]   |
| storage    | objects            | project members can upload files                | a   | null                                                                                                                                                                                                                                                                                                                                                                                                                          | ((bucket_id = 'media'::text) AND (auth.uid() IS NOT NULL))                                                                                                                                                                                                                                                                                                                                      | [0]   |


PG_POLICIES


| schemaname | tablename          | policyname                                      | permissive | roles    | cmd    | qual                                                                                                                                                                                                                                                                                                                                                                                                                          | with_check                                                                                                                                                                                                                                                                                                                                                                                      |
| ---------- | ------------------ | ----------------------------------------------- | ---------- | -------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public     | comments           | Clients can view comments on their deliverables | PERMISSIVE | {public} | SELECT | (((deliverable_id IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM (deliverables d
     JOIN projects p ON ((p.id = d.project_id)))
  WHERE ((p.client_id = auth.uid()) AND (d.id = comments.deliverable_id))))) OR ((media_asset_id IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM (media_assets ma
     JOIN projects p ON ((p.id = ma.project_id)))
  WHERE ((p.client_id = auth.uid()) AND (ma.id = comments.media_asset_id)))))) | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | comments           | Team can view all comments                      | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM (project_members pm
     JOIN deliverables d ON ((d.project_id = pm.project_id)))
  WHERE ((pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])) AND ((comments.deliverable_id = d.id) OR (comments.media_asset_id IS NOT NULL)))))                                                                                                                                   | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | deliverable_assets | Team can manage deliverable assets              | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM (project_members pm
     JOIN deliverables d ON ((d.project_id = pm.project_id)))
  WHERE ((d.id = deliverable_assets.deliverable_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | deliverable_assets | Clients can view own deliverable assets         | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM (deliverables d
     JOIN project_clients pc ON ((pc.project_id = d.project_id)))
  WHERE ((d.id = deliverable_assets.deliverable_id) AND (pc.user_id = auth.uid()))))                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | deliverables       | Clients can update own deliverable status       | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = deliverables.project_id) AND (p.client_id = auth.uid()))))                                                                                                                                                                                                                                                                                                             | (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = deliverables.project_id) AND (p.client_id = auth.uid()))))                                                                                                                                                                                                                                                                               |
| public     | deliverables       | Clients can view own project deliverables       | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = deliverables.project_id) AND (p.client_id = auth.uid()))))                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | deliverables       | Team can manage deliverables                    | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = deliverables.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | images             | images_admin_write                              | PERMISSIVE | {public} | ALL    | (auth.role() = 'admin'::text)                                                                                                                                                                                                                                                                                                                                                                                                 | (auth.role() = 'admin'::text)                                                                                                                                                                                                                                                                                                                                                                   |
| public     | media              | owners can insert media                         | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                         |
| public     | media              | owners can select media                         | PERMISSIVE | {public} | SELECT | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | media              | owners can update media                         | PERMISSIVE | {public} | UPDATE | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | media              | owners can delete media                         | PERMISSIVE | {public} | DELETE | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | media              | public media read                               | PERMISSIVE | {public} | SELECT | (visibility = 'public'::text)                                                                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | media_assets       | uploaders or admins can delete media            | PERMISSIVE | {public} | DELETE | ((uploaded_by = auth.uid()) OR (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()) AND (project_members.role = 'admin'::text)))))                                                                                                                                                                                           | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | media_assets       | Users can insert media                          | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = uploaded_by)                                                                                                                                                                                                                                                                                                                                                                      |
| public     | media_assets       | users can upload unassigned media               | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | ((project_id IS NULL) AND (auth.uid() = uploaded_by))                                                                                                                                                                                                                                                                                                                                           |
| public     | media_assets       | uploaders or admins can update media            | PERMISSIVE | {public} | UPDATE | ((uploaded_by = auth.uid()) OR (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()) AND (project_members.role = 'admin'::text)))))                                                                                                                                                                                           | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | media_assets       | team and admins can upload media                | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()) AND (project_members.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                  |
| public     | media_assets       | project members can view media                  | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = media_assets.project_id) AND (project_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | media_assets       | Clients can view own project media              | PERMISSIVE | {public} | SELECT | ((EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = media_assets.project_id) AND (p.client_id = auth.uid())))) OR (EXISTS ( SELECT 1
   FROM project_clients pc
  WHERE ((pc.user_id = auth.uid()) AND (pc.project_id = media_assets.project_id)))))                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | notifications      | Team or project client can insert notifications | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | ((EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = ((notifications.payload ->> 'project_id'::text))::uuid) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text]))))) OR (EXISTS ( SELECT 1
   FROM project_clients pc
  WHERE ((pc.project_id = ((notifications.payload ->> 'project_id'::text))::uuid) AND (pc.user_id = auth.uid()))))) |
| public     | notifications      | Users can update own notifications              | PERMISSIVE | {public} | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | notifications      | Users can view own notifications                | PERMISSIVE | {public} | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles           | users can manage own profile                    | PERMISSIVE | {public} | ALL    | (auth.uid() = id)                                                                                                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | project_clients    | Clients can view their project_clients          | PERMISSIVE | {public} | SELECT | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | project_clients    | Team can manage project_clients                 | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_clients.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                                                 | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_clients.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                   |
| public     | project_members    | users can view their project memberships        | PERMISSIVE | {public} | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | project_members    | admins and team can manage project members      | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_members.project_id) AND (pm.user_id = auth.uid()) AND (pm.role = ANY (ARRAY['admin'::text, 'team'::text])))))                                                                                                                                                                                                   |
| public     | projects           | members can view projects                       | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM project_members
  WHERE ((project_members.project_id = projects.id) AND (project_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | projects           | members can create projects                     | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() IS NOT NULL)                                                                                                                                                                                                                                                                                                                                                                        |
| storage    | objects            | project members can upload files                | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                          | ((bucket_id = 'media'::text) AND (auth.uid() IS NOT NULL))                                                                                                                                                                                                                                                                                                                                      |
| storage    | objects            | project members can read files                  | PERMISSIVE | {public} | SELECT | ((bucket_id = 'media'::text) AND (auth.uid() IS NOT NULL))                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                            |


Supabase Storage metadata (buckets & objects)


| bucket_id | name                                                                                                                     | id                                   | updated_at                    | metadata                                                                                                                                                                                                      | owner                                | last_accessed_at              |
| --------- | ------------------------------------------------------------------------------------------------------------------------ | ------------------------------------ | ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------ | ----------------------------- |
| media     | projects/.emptyFolderPlaceholder                                                                                         | 7c43a10d-6289-4f0a-adfc-78aab8f46182 | 2025-12-23 16:04:20.818372+00 | {"eTag":"\"d41d8cd98f00b204e9800998ecf8427e\"","size":0,"mimetype":"application/octet-stream","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:04:20.817Z","contentLength":0,"httpStatusCode":200} | null                                 | 2025-12-23 16:04:20.818372+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_3rzh2t_football_04.webp                    | 20118ef6-c85b-4fd4-a695-ffc992cf0d3a | 2025-12-23 20:49:19.030695+00 | {"eTag":"\"7d6369343b1d1de2cb2cfbb62a2c2d0e\"","size":50206,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:19.000Z","contentLength":50206,"httpStatusCode":200}       | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:19.030695+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_3vmve1_football_15.webp                    | 01807bed-0b25-4d1f-8dfc-bb496578d48a | 2025-12-23 20:49:25.469486+00 | {"eTag":"\"33653299b2232371253b0b460500c27a\"","size":42404,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:26.000Z","contentLength":42404,"httpStatusCode":200}       | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:25.469486+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_4rbtge_football_11.webp                    | e655e493-7462-449d-84d6-4eb9eadbe0eb | 2025-12-23 20:49:23.413099+00 | {"eTag":"\"e30a2fb4292016b2256e816cde2b9a2f\"","size":111994,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:24.000Z","contentLength":111994,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:23.413099+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_6h6c79_football_01.webp                    | 213751a1-a911-4da7-876f-f4df6fa52398 | 2025-12-23 20:49:17.369726+00 | {"eTag":"\"1ec2c3104a01c48845b75a054d7b6713\"","size":98864,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:18.000Z","contentLength":98864,"httpStatusCode":200}       | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:17.369726+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_8bn3ix_football_12.webp                    | 19ae47d5-3e05-4996-a0d4-25f3ec042c52 | 2025-12-23 20:49:23.930397+00 | {"eTag":"\"6e9e783a2a6b3ab672de0d2edcb00a91\"","size":113194,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:24.000Z","contentLength":113194,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:23.930397+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_9u9z3s_football_02.webp                    | 6fdd1486-1b74-4f06-80d6-fba7bf3a1340 | 2025-12-23 20:49:18.006907+00 | {"eTag":"\"68d481eb97887fe4d28540d3950dfd67\"","size":159058,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:18.000Z","contentLength":159058,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:18.006907+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_a12wpb_football_08.webp                    | 866034cc-6508-4d78-884b-9b2e71e07cae | 2025-12-23 20:49:21.74543+00  | {"eTag":"\"5b97eb7c7ad1f3ef17dcf64705fb38be\"","size":200940,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:22.000Z","contentLength":200940,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:21.74543+00  |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_ap2fhz_football_07.webp                    | 81d089bd-2948-4909-b53b-f96c96953e48 | 2025-12-23 20:49:20.958988+00 | {"eTag":"\"972ce44c07ea8baea6aea52ed9c59ee5\"","size":154782,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:21.000Z","contentLength":154782,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:20.958988+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_ffvupj_football_16.webp                    | 6558826d-676b-4044-8abf-5ef7c1307ce6 | 2025-12-23 20:49:26.148089+00 | {"eTag":"\"978b982a7dd1f4136f34a8d346ccc3aa\"","size":222280,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:27.000Z","contentLength":222280,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:26.148089+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_ipwcrn_football_09.webp                    | eac462f5-c2f1-4a09-8e78-ae72ad3f5114 | 2025-12-23 20:49:22.438921+00 | {"eTag":"\"59cb5ceb0846e250f08387d9a0f09f77\"","size":206896,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:23.000Z","contentLength":206896,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:22.438921+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_jexmjq_football_06.webp                    | 9cef9100-15b8-44cd-81fe-6f1ee289518c | 2025-12-23 20:49:20.381334+00 | {"eTag":"\"4dc915183b25de6c0b9b7fc73aa14446\"","size":206992,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:21.000Z","contentLength":206992,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:20.381334+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_qlj9r7_football_10.webp                    | e27c4109-52b8-4a81-9195-bd6783cb3eba | 2025-12-23 20:49:22.878164+00 | {"eTag":"\"504c85a87455612f29f912cef3a3c7a5\"","size":49572,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:23.000Z","contentLength":49572,"httpStatusCode":200}       | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:22.878164+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_qwf30t_football_14.webp                    | 90ccbc47-131b-4087-ad09-f9a4d0893ed1 | 2025-12-23 20:49:25.041753+00 | {"eTag":"\"277ffa49cacb0f0b32b9033c4c570648\"","size":135906,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:25.000Z","contentLength":135906,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:25.041753+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_rj8n5y_pexels-cottonbro-3297882.jpg        | 7be5e7d1-68ad-45ed-8507-65a9b41da8ce | 2025-12-23 20:38:57.630857+00 | {"eTag":"\"ee72411ce42c3cad5c8b301f80c4d003\"","size":561142,"mimetype":"image/jpeg","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:38:58.000Z","contentLength":561142,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:38:57.630857+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_srp3vj_football_13.webp                    | abd2dbd6-d63b-4a1c-a964-96e9de7502d8 | 2025-12-23 20:49:24.51017+00  | {"eTag":"\"7767b98b610e94ce5a7e8443d53b36ae\"","size":143200,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:25.000Z","contentLength":143200,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:24.51017+00  |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_uje9yi_football_03.webp                    | 14d946d9-35e1-4e16-b8ed-f3df5d491d50 | 2025-12-23 20:49:18.581195+00 | {"eTag":"\"2c8b10b632b98f30e72e822e654bbe8f\"","size":116228,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:19.000Z","contentLength":116228,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:18.581195+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_wynevr_football_pre.webp                   | 2270013d-a06a-434c-8877-b1ae1d7d8545 | 2025-12-23 20:49:26.704258+00 | {"eTag":"\"a77437d5f57d43b2274b487ded4edbf7\"","size":113194,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:27.000Z","contentLength":113194,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:26.704258+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/deliverable/2025-12-23_7764ea44_x5u6aq_football_05.webp                    | 7750d280-7880-476a-8b36-6ca51f9bf1c2 | 2025-12-23 20:49:19.672906+00 | {"eTag":"\"759c8a276f1df2e326c8ef10d82406ce\"","size":115164,"mimetype":"image/webp","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:49:20.000Z","contentLength":115164,"httpStatusCode":200}     | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:49:19.672906+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_1gx73c_ChatGPT_Image_Dec_21__2025__09_44_01_PM.png | 4ec863b5-7427-4d10-928c-e83cbc2e91a3 | 2025-12-23 16:21:19.270304+00 | {"eTag":"\"7d062662cd6982a8b6e27e2e8373899f\"","size":87940,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:20.000Z","contentLength":87940,"httpStatusCode":200}        | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:19.270304+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_2k3k91_ChatGPT_Image_Dec_21__2025__09_23_58_PM.png | 76cd4a5b-da5e-4d6b-9645-4ffcfc3c8318 | 2025-12-23 16:21:25.206988+00 | {"eTag":"\"491203e60861ebeb01606731c28ad6a4\"","size":2103338,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:26.000Z","contentLength":2103338,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:25.206988+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_4u8c7q_ChatGPT_Image_Dec_12__2025__09_05_48_PM.png | d8388746-5077-4a2d-b67c-11fe781bae7e | 2025-12-23 16:21:43.68944+00  | {"eTag":"\"09b811bfa48e7d22efd94acf2fe52e79\"","size":1107636,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:44.000Z","contentLength":1107636,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:43.68944+00  |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_8em744_ChatGPT_Image_Dec_21__2025__09_27_25_PM.png | 63d19d9f-9bd3-4782-8091-5be33cc4225a | 2025-12-23 16:21:21.811275+00 | {"eTag":"\"203a882871fe320093a5287bb42d7018\"","size":1423994,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:22.000Z","contentLength":1423994,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:21.811275+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_es0cnm_Crispy_Beef_Tacos.mp4                       | 42fff7f9-e717-431d-bf14-564aa525d1e9 | 2025-12-23 20:44:07.395088+00 | {"eTag":"\"49df6984548a3f92aabf7946f0d896da\"","size":3491949,"mimetype":"video/mp4","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:44:08.000Z","contentLength":3491949,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:44:07.395088+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_g4zrb3_3.png                                       | fcc84f78-95b3-4974-83d2-8ff91bdf012d | 2025-12-23 16:21:35.322819+00 | {"eTag":"\"ef5a74a1b500e90f6e1a20e9dacdd3ff\"","size":1396799,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:36.000Z","contentLength":1396799,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:35.322819+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_hatiqs_123.jpeg                                    | 9f5c831c-97af-44ae-9b3e-a7ed1f489281 | 2025-12-23 16:21:38.982491+00 | {"eTag":"\"b748c942984d95b949ae0136e6bc7856\"","size":2175117,"mimetype":"image/jpeg","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:39.000Z","contentLength":2175117,"httpStatusCode":200}   | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:38.982491+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_lxh62r_Hacker_in_the_Glow_of_Code.png              | 4102c631-626a-43a5-8452-8ac4cb4addb8 | 2025-12-23 16:21:48.956829+00 | {"eTag":"\"8412ae7ed15e82a18e590fee3fba8325\"","size":1127250,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:49.000Z","contentLength":1127250,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:48.956829+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_saqh2l_ChatGPT_Image_Dec_21__2025__09_14_02_PM.png | 1319765d-a697-4047-b816-af8c94927b60 | 2025-12-23 16:21:32.224053+00 | {"eTag":"\"c5e5d9f3bfc9af40749e48a5b112a3fa\"","size":1003959,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:33.000Z","contentLength":1003959,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:32.224053+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_udxsnh_ChatGPT_Image_Dec_12__2025__09_00_39_PM.png | 363d7411-5707-45e7-8d5b-61d8fd1e7616 | 2025-12-23 16:21:46.449639+00 | {"eTag":"\"ef819e6ad7b246168f529cde1ccc570d\"","size":1211733,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:47.000Z","contentLength":1211733,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:46.449639+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_wxd8nv_ChatGPT_Image_Dec_21__2025__09_44_56_PM.png | 311523e8-6647-4ccb-b8e3-7a42d2978898 | 2025-12-23 16:21:18.414148+00 | {"eTag":"\"af2e19108a192a04cb795ed00beba7ab\"","size":89369,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:19.000Z","contentLength":89369,"httpStatusCode":200}        | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:18.414148+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_ybp5nk_2.png                                       | 13adf31b-3273-41e0-a0ec-23fa0efc6ae0 | 2025-12-23 16:21:41.232673+00 | {"eTag":"\"4984638b220d03ab75613ab40b9123b6\"","size":1223177,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:42.000Z","contentLength":1223177,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:41.232673+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_zsr8kw_ChatGPT_Image_Dec_21__2025__09_22_45_PM.png | e537a258-71a2-4ceb-b896-066e673e37c2 | 2025-12-23 16:21:27.543268+00 | {"eTag":"\"4175f53362a7c3ba007ec51b8301d926\"","size":1142221,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:28.000Z","contentLength":1142221,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:27.543268+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/raw/2025-12-23_7764ea44_zu47tc_ChatGPT_Image_Dec_21__2025__09_18_19_PM.png | b58c0336-3149-4168-ba6b-95bc418d5c3e | 2025-12-23 16:21:30.104981+00 | {"eTag":"\"40ab3616378608a1615eaed24856f4c4\"","size":1384354,"mimetype":"image/png","cacheControl":"max-age=3600","lastModified":"2025-12-23T16:21:31.000Z","contentLength":1384354,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 16:21:30.104981+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/wip/2025-12-23_7764ea44_c1josk_Crispy_Beef_Tacos.mp4                       | 78daae05-f54d-4584-bab0-a42bcdc080f5 | 2025-12-23 20:43:28.805916+00 | {"eTag":"\"49df6984548a3f92aabf7946f0d896da\"","size":3491949,"mimetype":"video/mp4","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:43:29.000Z","contentLength":3491949,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:43:28.805916+00 |
| media     | projects/b92ea35c-03a3-4e26-ade3-e9e3140485e9/wip/2025-12-23_7764ea44_jb7dox_Crispy_Beef_Tacos.mp4                       | 2ab8004e-2096-45ca-ab00-be95b84a9776 | 2025-12-23 20:43:34.728288+00 | {"eTag":"\"49df6984548a3f92aabf7946f0d896da\"","size":3491949,"mimetype":"video/mp4","cacheControl":"max-age=3600","lastModified":"2025-12-23T20:43:35.000Z","contentLength":3491949,"httpStatusCode":200}    | 7764ea44-b9cc-4c5e-8840-17b8d91912f1 | 2025-12-23 20:43:34.728288+00 |
| media     | thumbnails/11bc0be2-47a9-4dee-a413-e5de183fe54c-300x300.jpg                                                              | 3d98a2ac-2a17-452a-8f1e-bde3df83b1ab | 2025-12-23 16:21:23.079738+00 | {"eTag":"\"53f77c43b4f09daef7ab541d7257a252\"","size":8505,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:24.000Z","contentLength":8505,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:23.079738+00 |
| media     | thumbnails/132d3462-46d9-4f74-ae9c-d0eb49cfee22-300x300.jpg                                                              | e142583b-b7c2-48cb-b6f6-5af6fc64e8b1 | 2025-12-23 20:49:18.320622+00 | {"eTag":"\"dd98d323637341eefa5cf2e0795437ad\"","size":15502,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:19.000Z","contentLength":15502,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:18.320622+00 |
| media     | thumbnails/1cfd5342-b028-4ae8-8b22-c5a4fb7e9b45-300x300.jpg                                                              | 8035e4a9-cc26-4b77-9db2-a23e7bde8d21 | 2025-12-23 20:49:22.573587+00 | {"eTag":"\"06919ba15af249fbdfe6b94e3983f40f\"","size":22246,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:23.000Z","contentLength":22246,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:22.573587+00 |
| media     | thumbnails/27e1f6d9-fb17-467e-978f-626b101c178b-300x300.jpg                                                              | 2dfe5a7b-1bcf-4ecb-8692-a698dda66c34 | 2025-12-23 16:21:40.013334+00 | {"eTag":"\"02078c00bf216a2804ae4a58e05c8efd\"","size":16482,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:40.000Z","contentLength":16482,"httpStatusCode":200}   | null                                 | 2025-12-23 16:21:40.013334+00 |
| media     | thumbnails/31ad8294-10ac-4d7a-b85f-ac888db51a8e-300x300.jpg                                                              | 4ce7a725-a725-4a40-bc33-95e5d5397c4d | 2025-12-23 16:21:42.605237+00 | {"eTag":"\"c870f5f40d952b581abf3e907b573b60\"","size":8561,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:43.000Z","contentLength":8561,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:42.605237+00 |
| media     | thumbnails/375010a1-786a-447f-b898-c491f609a80e-300x300.jpg                                                              | 8f65c4a3-b73b-41c3-842e-103c11b780cb | 2025-12-23 20:49:19.324292+00 | {"eTag":"\"1eba15ee1e1576a5309699a567686896\"","size":18782,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:20.000Z","contentLength":18782,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:19.324292+00 |
| media     | thumbnails/3f67798b-a328-442d-abc1-8b3ecb6e009d-300x300.jpg                                                              | 34b17bbe-68f1-49c5-bbff-e4840de1792e | 2025-12-23 16:21:44.854422+00 | {"eTag":"\"f45358d6c9b0894839456a2da6634aab\"","size":9429,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:45.000Z","contentLength":9429,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:44.854422+00 |
| media     | thumbnails/42a13d3e-8828-4000-9fc2-0534fb7f1b59-300x300.jpg                                                              | b8d27fab-45f7-49ae-b968-fa2b2526e9a0 | 2025-12-23 20:49:25.13957+00  | {"eTag":"\"fe42925dbafcb734a5caa90ebe7fbea6\"","size":20986,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:26.000Z","contentLength":20986,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:25.13957+00  |
| media     | thumbnails/4b8e32a5-1943-4742-b5e3-e924500746ab-300x300.jpg                                                              | 12b0a029-b2ac-4830-8d2f-0791468d4f2e | 2025-12-23 16:21:28.702557+00 | {"eTag":"\"0d8cde8328a2093bbe5762437db456fb\"","size":13460,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:29.000Z","contentLength":13460,"httpStatusCode":200}   | null                                 | 2025-12-23 16:21:28.702557+00 |
| media     | thumbnails/5772cb70-5c73-476c-96dc-c42ce0d223ba-300x300.jpg                                                              | c6fde20c-3e27-4a39-aaab-1b1d0e9d0615 | 2025-12-23 16:21:19.596589+00 | {"eTag":"\"56265aa0578b5510bbbea5303536bc21\"","size":8847,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:20.000Z","contentLength":8847,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:19.596589+00 |
| media     | thumbnails/622b0c28-fddf-4a9b-a9fa-a31e2593a94c-300x300.jpg                                                              | b6e5e508-b8d9-48ef-98a8-6c0c7eef01bd | 2025-12-23 20:49:19.721815+00 | {"eTag":"\"e58f0c6322db5ad6cef67c8844764f90\"","size":11210,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:20.000Z","contentLength":11210,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:19.721815+00 |
| media     | thumbnails/65c5dbb3-ad91-42b5-ae69-3e3f6ea93610-300x300.jpg                                                              | c9d0222d-8fd0-412e-9407-7beb35dc2ce8 | 2025-12-23 20:49:23.279987+00 | {"eTag":"\"5e9c0e8ec92a39a7ffbf551034a2d814\"","size":16249,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:24.000Z","contentLength":16249,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:23.279987+00 |
| media     | thumbnails/68b82b5b-ff84-4ba9-a47c-bbcf1b313d79-300x300.jpg                                                              | 54064edf-886f-4edc-8879-23d6d189f0b6 | 2025-12-23 16:21:50.214978+00 | {"eTag":"\"5679f11d6a3a0db1f1ed90c7e9d62110\"","size":9587,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:51.000Z","contentLength":9587,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:50.214978+00 |
| media     | thumbnails/6a994d9d-4b66-49a0-95af-e3b195193f3a-300x300.jpg                                                              | 1c4f4fc3-f014-4941-8d88-fe65a5753eea | 2025-12-23 20:49:26.146831+00 | {"eTag":"\"c12d0edbcd0581f8b00a4aa66e78318e\"","size":23564,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:27.000Z","contentLength":23564,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:26.146831+00 |
| media     | thumbnails/6aaf9749-cb07-44df-be5a-ea891a6dc59f-300x300.jpg                                                              | 437e5d2f-4412-4be0-be28-4db48e1039de | 2025-12-23 20:49:21.206739+00 | {"eTag":"\"938f53b4972edffdb8f80beaaba91fb9\"","size":16482,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:22.000Z","contentLength":16482,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:21.206739+00 |
| media     | thumbnails/6ace9146-0d59-42bb-80b4-13db85b6bfec-300x300.jpg                                                              | d72d880e-db96-41a9-8b34-5e799d28c7d3 | 2025-12-23 16:21:47.322832+00 | {"eTag":"\"317b9151bc0567f1bc53ae14133b79a4\"","size":9437,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:48.000Z","contentLength":9437,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:47.322832+00 |
| media     | thumbnails/78ac83f7-a7a6-450a-8b20-109899d65b6b-300x300.jpg                                                              | 3d3055e6-0234-463f-8fe6-6ed2904888f8 | 2025-12-23 16:21:19.948918+00 | {"eTag":"\"fd37fdc8b02ae971ee8bcc26846d450c\"","size":8074,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:20.000Z","contentLength":8074,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:19.948918+00 |
| media     | thumbnails/7a758276-b0a6-46f7-b0b6-0d6a627cce29-300x300.jpg                                                              | df22f1c2-9e46-465d-8f99-89a9286ba414 | 2025-12-23 16:21:36.609921+00 | {"eTag":"\"33c404ce5a3daa31b903937e2959e0e7\"","size":8465,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:37.000Z","contentLength":8465,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:36.609921+00 |
| media     | thumbnails/7d1996f3-4a43-493a-8f9c-d920cfceb003-300x300.jpg                                                              | 479060c9-b253-42de-8685-639e27325c39 | 2025-12-23 16:21:26.507955+00 | {"eTag":"\"baf986828804420715f5bb2fa9c3e9a0\"","size":14841,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:27.000Z","contentLength":14841,"httpStatusCode":200}   | null                                 | 2025-12-23 16:21:26.507955+00 |
| media     | thumbnails/812511f9-cbb5-4c9d-8fb7-aba73ff1b4fb-300x300.jpg                                                              | 71b46195-fee8-4c96-9246-0b379b4445f3 | 2025-12-23 20:49:27.472317+00 | {"eTag":"\"51b6247d370577eac066c55acc22464e\"","size":14269,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:28.000Z","contentLength":14269,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:27.472317+00 |
| media     | thumbnails/8424d5a3-8acb-4822-9386-b1a881149e32-300x300.jpg                                                              | e3373d40-c791-4c01-9214-f5e6348572d7 | 2025-12-23 20:49:23.612197+00 | {"eTag":"\"a0107fbad45fb562e2069ca1f35b3e1d\"","size":11900,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:24.000Z","contentLength":11900,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:23.612197+00 |
| media     | thumbnails/858b8a29-2ad2-4538-a2e2-95035dd7a56a-300x300.jpg                                                              | ede54234-2e8d-4055-8bef-c23b7ee2cab5 | 2025-12-23 20:49:20.437203+00 | {"eTag":"\"fb7cce70afbf56d3f398aa82388ca4a8\"","size":18293,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:21.000Z","contentLength":18293,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:20.437203+00 |
| media     | thumbnails/9742ddd2-5345-4bf9-b60b-6c6328a10431-300x300.jpg                                                              | 147c2172-831c-4d34-a8d5-8d814568aadf | 2025-12-23 16:21:33.374352+00 | {"eTag":"\"ba2a609b7f383c4f754f5d94f6767829\"","size":7596,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:34.000Z","contentLength":7596,"httpStatusCode":200}     | null                                 | 2025-12-23 16:21:33.374352+00 |
| media     | thumbnails/9b95c881-9e8a-4a07-b6ee-6ebd351469ee-300x300.jpg                                                              | 5b604f3a-6ec9-45af-957e-1c5ff90d8352 | 2025-12-23 20:49:24.754959+00 | {"eTag":"\"51b6247d370577eac066c55acc22464e\"","size":14269,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:25.000Z","contentLength":14269,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:24.754959+00 |
| media     | thumbnails/ad54f18d-b9dc-4789-bc29-4225af5d2cdf-300x300.jpg                                                              | 17690167-bec0-4bf8-899b-1545c8d54742 | 2025-12-23 20:49:18.817721+00 | {"eTag":"\"049ae66f3703642a61f7e82fae9ce0ec\"","size":19010,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:19.000Z","contentLength":19010,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:18.817721+00 |
| media     | thumbnails/b7c8ca0b-e42a-490c-a29e-5a0e069a05dd-300x300.jpg                                                              | d018f544-9d58-443f-b9d6-6b287709c11f | 2025-12-23 20:49:24.127354+00 | {"eTag":"\"44c28e740f74c09f888c1eacf27c16cd\"","size":19864,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:25.000Z","contentLength":19864,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:24.127354+00 |
| media     | thumbnails/c6de36c9-5ae4-41fd-9097-2ea9455c87a2-300x300.jpg                                                              | 79f92af1-0592-4177-acc5-39c5b17acf58 | 2025-12-23 16:21:31.172129+00 | {"eTag":"\"22e47664124e5000a949d1de8b26d220\"","size":11865,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T16:21:32.000Z","contentLength":11865,"httpStatusCode":200}   | null                                 | 2025-12-23 16:21:31.172129+00 |
| media     | thumbnails/ce169cdc-1f98-4f23-a85e-26661b6ea3a1-300x300.jpg                                                              | 8ad10b4f-939b-476d-9d34-b7dd160a7cbd | 2025-12-23 20:49:26.057067+00 | {"eTag":"\"0ecd215288ae90505e0ad5d2be957002\"","size":11109,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:27.000Z","contentLength":11109,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:26.057067+00 |
| media     | thumbnails/dbcbdaae-12be-4f09-8edc-529f18c9c33c-300x300.jpg                                                              | fab2fac3-5feb-422b-a007-87546231f937 | 2025-12-23 20:49:21.699351+00 | {"eTag":"\"f52f2b6e214f637291153a39eaceda3e\"","size":23295,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:22.000Z","contentLength":23295,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:21.699351+00 |
| media     | thumbnails/e2ea6eaf-faba-4170-9e7e-a5e377bb5db1-300x300.jpg                                                              | b07f4cc0-426c-4854-b4e3-3596c938b4ba | 2025-12-23 20:38:59.145415+00 | {"eTag":"\"208fce36990103a6fd17a431a46cbf00\"","size":15435,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:39:00.000Z","contentLength":15435,"httpStatusCode":200}   | null                                 | 2025-12-23 20:38:59.145415+00 |
| media     | thumbnails/fb840c5f-7ea3-40e7-9927-aaf89ad988a1-300x300.jpg                                                              | e3f76f44-5150-433f-b4aa-aa6ad6a24b74 | 2025-12-23 20:49:27.439239+00 | {"eTag":"\"e33c35ee25d061fdb93dcd35ad0f8649\"","size":11891,"mimetype":"image/jpeg","cacheControl":"max-age=31536000","lastModified":"2025-12-23T20:49:28.000Z","contentLength":11891,"httpStatusCode":200}   | null                                 | 2025-12-23 20:49:27.439239+00 |



Roles, grants and service keys


| grantee                 | table_schema | table_name                  | privilege_type |
| ----------------------- | ------------ | --------------------------- | -------------- |
| PUBLIC                  | extensions   | pg_stat_statements          | SELECT         |
| PUBLIC                  | extensions   | pg_stat_statements_info     | SELECT         |
| anon                    | public       | client_deliverable_status   | DELETE         |
| anon                    | public       | client_deliverable_status   | INSERT         |
| anon                    | public       | client_deliverable_status   | SELECT         |
| anon                    | public       | client_deliverable_status   | UPDATE         |
| anon                    | public       | client_deliverable_status   | REFERENCES     |
| anon                    | public       | client_deliverable_status   | TRIGGER        |
| anon                    | public       | client_deliverable_status   | TRUNCATE       |
| anon                    | public       | comments                    | INSERT         |
| anon                    | public       | comments                    | TRIGGER        |
| anon                    | public       | comments                    | TRUNCATE       |
| anon                    | public       | comments                    | DELETE         |
| anon                    | public       | comments                    | UPDATE         |
| anon                    | public       | comments                    | SELECT         |
| anon                    | public       | comments                    | REFERENCES     |
| anon                    | public       | deliverable_assets          | UPDATE         |
| anon                    | public       | deliverable_assets          | DELETE         |
| anon                    | public       | deliverable_assets          | TRUNCATE       |
| anon                    | public       | deliverable_assets          | REFERENCES     |
| anon                    | public       | deliverable_assets          | TRIGGER        |
| anon                    | public       | deliverable_assets          | INSERT         |
| anon                    | public       | deliverable_assets          | SELECT         |
| anon                    | public       | deliverables                | TRUNCATE       |
| anon                    | public       | deliverables                | TRIGGER        |
| anon                    | public       | deliverables                | REFERENCES     |
| anon                    | public       | deliverables                | DELETE         |
| anon                    | public       | deliverables                | UPDATE         |
| anon                    | public       | deliverables                | SELECT         |
| anon                    | public       | deliverables                | INSERT         |
| anon                    | public       | hero_slots                  | TRUNCATE       |
| anon                    | public       | hero_slots                  | SELECT         |
| anon                    | public       | hero_slots                  | UPDATE         |
| anon                    | public       | hero_slots                  | DELETE         |
| anon                    | public       | hero_slots                  | TRIGGER        |
| anon                    | public       | hero_slots                  | REFERENCES     |
| anon                    | public       | hero_slots                  | INSERT         |
| anon                    | public       | images                      | TRUNCATE       |
| anon                    | public       | images                      | UPDATE         |
| anon                    | public       | images                      | SELECT         |
| anon                    | public       | images                      | TRIGGER        |
| anon                    | public       | images                      | REFERENCES     |
| anon                    | public       | images                      | INSERT         |
| anon                    | public       | images                      | DELETE         |
| anon                    | public       | media                       | REFERENCES     |
| anon                    | public       | media                       | UPDATE         |
| anon                    | public       | media                       | DELETE         |
| anon                    | public       | media                       | TRUNCATE       |
| anon                    | public       | media                       | INSERT         |
| anon                    | public       | media                       | SELECT         |
| anon                    | public       | media                       | TRIGGER        |
| anon                    | public       | media_assets                | TRUNCATE       |
| anon                    | public       | media_assets                | UPDATE         |
| anon                    | public       | media_assets                | SELECT         |
| anon                    | public       | media_assets                | INSERT         |
| anon                    | public       | media_assets                | TRIGGER        |
| anon                    | public       | media_assets                | REFERENCES     |
| anon                    | public       | media_assets                | DELETE         |
| anon                    | public       | notifications               | REFERENCES     |
| anon                    | public       | notifications               | UPDATE         |
| anon                    | public       | notifications               | DELETE         |
| anon                    | public       | notifications               | TRUNCATE       |
| anon                    | public       | notifications               | SELECT         |
| anon                    | public       | notifications               | TRIGGER        |
| anon                    | public       | notifications               | INSERT         |
| anon                    | public       | portfolio_items             | REFERENCES     |
| anon                    | public       | portfolio_items             | SELECT         |
| anon                    | public       | portfolio_items             | UPDATE         |
| anon                    | public       | portfolio_items             | DELETE         |
| anon                    | public       | portfolio_items             | TRUNCATE       |
| anon                    | public       | portfolio_items             | TRIGGER        |
| anon                    | public       | portfolio_items             | INSERT         |
| anon                    | public       | portfolio_items_with_images | SELECT         |
| anon                    | public       | portfolio_items_with_images | INSERT         |
| anon                    | public       | portfolio_items_with_images | UPDATE         |
| anon                    | public       | portfolio_items_with_images | DELETE         |
| anon                    | public       | portfolio_items_with_images | TRUNCATE       |
| anon                    | public       | portfolio_items_with_images | REFERENCES     |
| anon                    | public       | portfolio_items_with_images | TRIGGER        |
| anon                    | public       | profiles                    | DELETE         |
| anon                    | public       | profiles                    | TRUNCATE       |
| anon                    | public       | profiles                    | REFERENCES     |
| anon                    | public       | profiles                    | TRIGGER        |
| anon                    | public       | profiles                    | INSERT         |
| anon                    | public       | profiles                    | SELECT         |
| anon                    | public       | profiles                    | UPDATE         |
| anon                    | public       | project_clients             | DELETE         |
| anon                    | public       | project_clients             | TRUNCATE       |
| anon                    | public       | project_clients             | REFERENCES     |
| anon                    | public       | project_clients             | TRIGGER        |
| anon                    | public       | project_clients             | INSERT         |
| anon                    | public       | project_clients             | SELECT         |
| anon                    | public       | project_clients             | UPDATE         |
| anon                    | public       | project_members             | REFERENCES     |
| anon                    | public       | project_members             | TRIGGER        |
| anon                    | public       | project_members             | TRUNCATE       |
| anon                    | public       | project_members             | DELETE         |
| anon                    | public       | project_members             | UPDATE         |
| anon                    | public       | project_members             | SELECT         |
| anon                    | public       | project_members             | INSERT         |
| anon                    | public       | projects                    | TRIGGER        |
| anon                    | public       | projects                    | REFERENCES     |
| anon                    | public       | projects                    | INSERT         |
| anon                    | public       | projects                    | SELECT         |
| anon                    | public       | projects                    | UPDATE         |
| anon                    | public       | projects                    | DELETE         |
| anon                    | public       | projects                    | TRUNCATE       |
| anon                    | public       | site_images                 | UPDATE         |
| anon                    | public       | site_images                 | SELECT         |
| anon                    | public       | site_images                 | INSERT         |
| anon                    | public       | site_images                 | TRIGGER        |
| anon                    | public       | site_images                 | REFERENCES     |
| anon                    | public       | site_images                 | TRUNCATE       |
| anon                    | public       | site_images                 | DELETE         |
| anon                    | public       | user_profiles               | REFERENCES     |
| anon                    | public       | user_profiles               | TRIGGER        |
| anon                    | public       | user_profiles               | TRUNCATE       |
| anon                    | public       | user_profiles               | DELETE         |
| anon                    | public       | user_profiles               | UPDATE         |
| anon                    | public       | user_profiles               | SELECT         |
| anon                    | public       | user_profiles               | INSERT         |
| anon                    | realtime     | messages                    | INSERT         |
| anon                    | realtime     | messages                    | SELECT         |
| anon                    | realtime     | messages                    | UPDATE         |
| anon                    | realtime     | schema_migrations           | SELECT         |
| anon                    | realtime     | subscription                | SELECT         |
| anon                    | storage      | buckets                     | REFERENCES     |
| anon                    | storage      | buckets                     | UPDATE         |
| anon                    | storage      | buckets                     | INSERT         |
| anon                    | storage      | buckets                     | DELETE         |
| anon                    | storage      | buckets                     | TRUNCATE       |
| anon                    | storage      | buckets                     | SELECT         |
| anon                    | storage      | buckets                     | TRIGGER        |
| anon                    | storage      | buckets_analytics           | TRIGGER        |
| anon                    | storage      | buckets_analytics           | INSERT         |
| anon                    | storage      | buckets_analytics           | SELECT         |
| anon                    | storage      | buckets_analytics           | UPDATE         |
| anon                    | storage      | buckets_analytics           | DELETE         |
| anon                    | storage      | buckets_analytics           | TRUNCATE       |
| anon                    | storage      | buckets_analytics           | REFERENCES     |
| anon                    | storage      | buckets_vectors             | SELECT         |
| anon                    | storage      | objects                     | SELECT         |
| anon                    | storage      | objects                     | TRIGGER        |
| anon                    | storage      | objects                     | REFERENCES     |
| anon                    | storage      | objects                     | TRUNCATE       |
| anon                    | storage      | objects                     | DELETE         |
| anon                    | storage      | objects                     | UPDATE         |
| anon                    | storage      | objects                     | INSERT         |
| anon                    | storage      | prefixes                    | INSERT         |
| anon                    | storage      | prefixes                    | SELECT         |
| anon                    | storage      | prefixes                    | UPDATE         |
| anon                    | storage      | prefixes                    | DELETE         |
| anon                    | storage      | prefixes                    | TRUNCATE       |
| anon                    | storage      | prefixes                    | REFERENCES     |
| anon                    | storage      | prefixes                    | TRIGGER        |
| anon                    | storage      | s3_multipart_uploads        | SELECT         |
| anon                    | storage      | s3_multipart_uploads_parts  | SELECT         |
| anon                    | storage      | vector_indexes              | SELECT         |
| authenticated           | public       | client_deliverable_status   | INSERT         |
| authenticated           | public       | client_deliverable_status   | TRIGGER        |
| authenticated           | public       | client_deliverable_status   | REFERENCES     |
| authenticated           | public       | client_deliverable_status   | TRUNCATE       |
| authenticated           | public       | client_deliverable_status   | DELETE         |
| authenticated           | public       | client_deliverable_status   | UPDATE         |
| authenticated           | public       | client_deliverable_status   | SELECT         |
| authenticated           | public       | comments                    | DELETE         |
| authenticated           | public       | comments                    | INSERT         |
| authenticated           | public       | comments                    | TRIGGER        |
| authenticated           | public       | comments                    | SELECT         |
| authenticated           | public       | comments                    | UPDATE         |
| authenticated           | public       | comments                    | REFERENCES     |
| authenticated           | public       | comments                    | TRUNCATE       |
| authenticated           | public       | deliverable_assets          | REFERENCES     |
| authenticated           | public       | deliverable_assets          | INSERT         |
| authenticated           | public       | deliverable_assets          | SELECT         |
| authenticated           | public       | deliverable_assets          | UPDATE         |
| authenticated           | public       | deliverable_assets          | DELETE         |
| authenticated           | public       | deliverable_assets          | TRUNCATE       |
| authenticated           | public       | deliverable_assets          | TRIGGER        |
| authenticated           | public       | deliverables                | REFERENCES     |
| authenticated           | public       | deliverables                | DELETE         |
| authenticated           | public       | deliverables                | TRUNCATE       |
| authenticated           | public       | deliverables                | TRIGGER        |
| authenticated           | public       | deliverables                | UPDATE         |
| authenticated           | public       | deliverables                | SELECT         |
| authenticated           | public       | deliverables                | INSERT         |
| authenticated           | public       | hero_slots                  | TRIGGER        |
| authenticated           | public       | hero_slots                  | INSERT         |
| authenticated           | public       | hero_slots                  | SELECT         |
| authenticated           | public       | hero_slots                  | UPDATE         |
| authenticated           | public       | hero_slots                  | DELETE         |
| authenticated           | public       | hero_slots                  | TRUNCATE       |
| authenticated           | public       | hero_slots                  | REFERENCES     |
| authenticated           | public       | images                      | TRIGGER        |
| authenticated           | public       | images                      | DELETE         |
| authenticated           | public       | images                      | UPDATE         |
| authenticated           | public       | images                      | SELECT         |
| authenticated           | public       | images                      | INSERT         |
| authenticated           | public       | images                      | TRUNCATE       |
| authenticated           | public       | images                      | REFERENCES     |
| authenticated           | public       | media                       | TRIGGER        |
| authenticated           | public       | media                       | TRUNCATE       |
| authenticated           | public       | media                       | DELETE         |
| authenticated           | public       | media                       | UPDATE         |
| authenticated           | public       | media                       | SELECT         |
| authenticated           | public       | media                       | INSERT         |
| authenticated           | public       | media                       | REFERENCES     |
| authenticated           | public       | media_assets                | REFERENCES     |
| authenticated           | public       | media_assets                | INSERT         |
| authenticated           | public       | media_assets                | SELECT         |
| authenticated           | public       | media_assets                | UPDATE         |
| authenticated           | public       | media_assets                | DELETE         |
| authenticated           | public       | media_assets                | TRUNCATE       |
| authenticated           | public       | media_assets                | TRIGGER        |
| authenticated           | public       | notifications               | TRIGGER        |
| authenticated           | public       | notifications               | INSERT         |
| authenticated           | public       | notifications               | REFERENCES     |
| authenticated           | public       | notifications               | TRUNCATE       |
| authenticated           | public       | notifications               | DELETE         |
| authenticated           | public       | notifications               | UPDATE         |
| authenticated           | public       | notifications               | SELECT         |
| authenticated           | public       | portfolio_items             | INSERT         |
| authenticated           | public       | portfolio_items             | TRIGGER        |
| authenticated           | public       | portfolio_items             | REFERENCES     |
| authenticated           | public       | portfolio_items             | TRUNCATE       |
| authenticated           | public       | portfolio_items             | DELETE         |
| authenticated           | public       | portfolio_items             | UPDATE         |
| authenticated           | public       | portfolio_items             | SELECT         |
| authenticated           | public       | portfolio_items_with_images | TRIGGER        |
| authenticated           | public       | portfolio_items_with_images | INSERT         |
| authenticated           | public       | portfolio_items_with_images | SELECT         |
| authenticated           | public       | portfolio_items_with_images | UPDATE         |
| authenticated           | public       | portfolio_items_with_images | DELETE         |
| authenticated           | public       | portfolio_items_with_images | TRUNCATE       |
| authenticated           | public       | portfolio_items_with_images | REFERENCES     |
| authenticated           | public       | profiles                    | SELECT         |
| authenticated           | public       | profiles                    | TRIGGER        |
| authenticated           | public       | profiles                    | REFERENCES     |
| authenticated           | public       | profiles                    | TRUNCATE       |
| authenticated           | public       | profiles                    | DELETE         |
| authenticated           | public       | profiles                    | UPDATE         |
| authenticated           | public       | profiles                    | INSERT         |
| authenticated           | public       | project_clients             | INSERT         |
| authenticated           | public       | project_clients             | TRIGGER        |
| authenticated           | public       | project_clients             | REFERENCES     |
| authenticated           | public       | project_clients             | TRUNCATE       |
| authenticated           | public       | project_clients             | DELETE         |
| authenticated           | public       | project_clients             | UPDATE         |
| authenticated           | public       | project_clients             | SELECT         |
| authenticated           | public       | project_members             | TRIGGER        |
| authenticated           | public       | project_members             | INSERT         |
| authenticated           | public       | project_members             | SELECT         |
| authenticated           | public       | project_members             | UPDATE         |
| authenticated           | public       | project_members             | DELETE         |
| authenticated           | public       | project_members             | TRUNCATE       |
| authenticated           | public       | project_members             | REFERENCES     |
| authenticated           | public       | projects                    | TRUNCATE       |
| authenticated           | public       | projects                    | DELETE         |
| authenticated           | public       | projects                    | UPDATE         |
| authenticated           | public       | projects                    | INSERT         |
| authenticated           | public       | projects                    | SELECT         |
| authenticated           | public       | projects                    | TRIGGER        |
| authenticated           | public       | projects                    | REFERENCES     |
| authenticated           | public       | site_images                 | DELETE         |
| authenticated           | public       | site_images                 | SELECT         |
| authenticated           | public       | site_images                 | INSERT         |
| authenticated           | public       | site_images                 | TRIGGER        |
| authenticated           | public       | site_images                 | REFERENCES     |
| authenticated           | public       | site_images                 | TRUNCATE       |
| authenticated           | public       | site_images                 | UPDATE         |
| authenticated           | public       | user_profiles               | SELECT         |
| authenticated           | public       | user_profiles               | INSERT         |
| authenticated           | public       | user_profiles               | REFERENCES     |
| authenticated           | public       | user_profiles               | TRUNCATE       |
| authenticated           | public       | user_profiles               | DELETE         |
| authenticated           | public       | user_profiles               | UPDATE         |
| authenticated           | public       | user_profiles               | TRIGGER        |
| authenticated           | realtime     | messages                    | UPDATE         |
| authenticated           | realtime     | messages                    | SELECT         |
| authenticated           | realtime     | messages                    | INSERT         |
| authenticated           | realtime     | schema_migrations           | SELECT         |
| authenticated           | realtime     | subscription                | SELECT         |
| authenticated           | storage      | buckets                     | INSERT         |
| authenticated           | storage      | buckets                     | TRIGGER        |
| authenticated           | storage      | buckets                     | REFERENCES     |
| authenticated           | storage      | buckets                     | TRUNCATE       |
| authenticated           | storage      | buckets                     | SELECT         |
| authenticated           | storage      | buckets                     | UPDATE         |
| authenticated           | storage      | buckets                     | DELETE         |
| authenticated           | storage      | buckets_analytics           | REFERENCES     |
| authenticated           | storage      | buckets_analytics           | SELECT         |
| authenticated           | storage      | buckets_analytics           | UPDATE         |
| authenticated           | storage      | buckets_analytics           | DELETE         |
| authenticated           | storage      | buckets_analytics           | TRUNCATE       |
| authenticated           | storage      | buckets_analytics           | INSERT         |
| authenticated           | storage      | buckets_analytics           | TRIGGER        |
| authenticated           | storage      | buckets_vectors             | SELECT         |
| authenticated           | storage      | objects                     | DELETE         |
| authenticated           | storage      | objects                     | UPDATE         |
| authenticated           | storage      | objects                     | SELECT         |
| authenticated           | storage      | objects                     | TRUNCATE       |
| authenticated           | storage      | objects                     | INSERT         |
| authenticated           | storage      | objects                     | TRIGGER        |
| authenticated           | storage      | objects                     | REFERENCES     |
| authenticated           | storage      | prefixes                    | UPDATE         |
| authenticated           | storage      | prefixes                    | SELECT         |
| authenticated           | storage      | prefixes                    | TRIGGER        |
| authenticated           | storage      | prefixes                    | INSERT         |
| authenticated           | storage      | prefixes                    | REFERENCES     |
| authenticated           | storage      | prefixes                    | TRUNCATE       |
| authenticated           | storage      | prefixes                    | DELETE         |
| authenticated           | storage      | s3_multipart_uploads        | SELECT         |
| authenticated           | storage      | s3_multipart_uploads_parts  | SELECT         |
| authenticated           | storage      | vector_indexes              | SELECT         |
| dashboard_user          | extensions   | pg_stat_statements          | REFERENCES     |
| dashboard_user          | extensions   | pg_stat_statements          | INSERT         |
| dashboard_user          | extensions   | pg_stat_statements          | SELECT         |
| dashboard_user          | extensions   | pg_stat_statements          | UPDATE         |
| dashboard_user          | extensions   | pg_stat_statements          | DELETE         |
| dashboard_user          | extensions   | pg_stat_statements          | TRUNCATE       |
| dashboard_user          | extensions   | pg_stat_statements          | TRIGGER        |
| dashboard_user          | extensions   | pg_stat_statements_info     | TRUNCATE       |
| dashboard_user          | extensions   | pg_stat_statements_info     | DELETE         |
| dashboard_user          | extensions   | pg_stat_statements_info     | INSERT         |
| dashboard_user          | extensions   | pg_stat_statements_info     | UPDATE         |
| dashboard_user          | extensions   | pg_stat_statements_info     | SELECT         |
| dashboard_user          | extensions   | pg_stat_statements_info     | REFERENCES     |
| dashboard_user          | extensions   | pg_stat_statements_info     | TRIGGER        |
| dashboard_user          | realtime     | messages                    | TRUNCATE       |
| dashboard_user          | realtime     | messages                    | INSERT         |
| dashboard_user          | realtime     | messages                    | SELECT         |
| dashboard_user          | realtime     | messages                    | UPDATE         |
| dashboard_user          | realtime     | messages                    | DELETE         |
| dashboard_user          | realtime     | messages                    | REFERENCES     |
| dashboard_user          | realtime     | messages                    | TRIGGER        |
| postgres                | auth         | audit_log_entries           | TRUNCATE       |
| postgres                | auth         | audit_log_entries           | DELETE         |
| postgres                | auth         | audit_log_entries           | UPDATE         |
| postgres                | auth         | audit_log_entries           | SELECT         |
| postgres                | auth         | audit_log_entries           | INSERT         |
| postgres                | auth         | audit_log_entries           | TRIGGER        |
| postgres                | auth         | audit_log_entries           | REFERENCES     |
| postgres                | auth         | flow_state                  | INSERT         |
| postgres                | auth         | flow_state                  | TRIGGER        |
| postgres                | auth         | flow_state                  | REFERENCES     |
| postgres                | auth         | flow_state                  | TRUNCATE       |
| postgres                | auth         | flow_state                  | DELETE         |
| postgres                | auth         | flow_state                  | UPDATE         |
| postgres                | auth         | flow_state                  | SELECT         |
| postgres                | auth         | identities                  | SELECT         |
| postgres                | auth         | identities                  | TRIGGER        |
| postgres                | auth         | identities                  | REFERENCES     |
| postgres                | auth         | identities                  | TRUNCATE       |
| postgres                | auth         | identities                  | DELETE         |
| postgres                | auth         | identities                  | UPDATE         |
| postgres                | auth         | identities                  | INSERT         |
| postgres                | auth         | instances                   | UPDATE         |
| postgres                | auth         | instances                   | DELETE         |
| postgres                | auth         | instances                   | TRIGGER        |
| postgres                | auth         | instances                   | REFERENCES     |
| postgres                | auth         | instances                   | TRUNCATE       |
| postgres                | auth         | instances                   | SELECT         |
| postgres                | auth         | instances                   | INSERT         |
| postgres                | auth         | mfa_amr_claims              | TRUNCATE       |
| postgres                | auth         | mfa_amr_claims              | TRIGGER        |
| postgres                | auth         | mfa_amr_claims              | REFERENCES     |
| postgres                | auth         | mfa_amr_claims              | DELETE         |
| postgres                | auth         | mfa_amr_claims              | UPDATE         |
| postgres                | auth         | mfa_amr_claims              | SELECT         |
| postgres                | auth         | mfa_amr_claims              | INSERT         |
| postgres                | auth         | mfa_challenges              | INSERT         |
| postgres                | auth         | mfa_challenges              | TRIGGER        |
| postgres                | auth         | mfa_challenges              | SELECT         |
| postgres                | auth         | mfa_challenges              | UPDATE         |
| postgres                | auth         | mfa_challenges              | DELETE         |
| postgres                | auth         | mfa_challenges              | TRUNCATE       |
| postgres                | auth         | mfa_challenges              | REFERENCES     |
| postgres                | auth         | mfa_factors                 | TRUNCATE       |
| postgres                | auth         | mfa_factors                 | TRIGGER        |
| postgres                | auth         | mfa_factors                 | INSERT         |
| postgres                | auth         | mfa_factors                 | SELECT         |
| postgres                | auth         | mfa_factors                 | UPDATE         |
| postgres                | auth         | mfa_factors                 | DELETE         |
| postgres                | auth         | mfa_factors                 | REFERENCES     |
| postgres                | auth         | oauth_authorizations        | REFERENCES     |
| postgres                | auth         | oauth_authorizations        | TRIGGER        |
| postgres                | auth         | oauth_authorizations        | INSERT         |
| postgres                | auth         | oauth_authorizations        | SELECT         |
| postgres                | auth         | oauth_authorizations        | UPDATE         |
| postgres                | auth         | oauth_authorizations        | DELETE         |
| postgres                | auth         | oauth_authorizations        | TRUNCATE       |
| postgres                | auth         | oauth_client_states         | TRIGGER        |
| postgres                | auth         | oauth_client_states         | REFERENCES     |
| postgres                | auth         | oauth_client_states         | TRUNCATE       |
| postgres                | auth         | oauth_client_states         | DELETE         |
| postgres                | auth         | oauth_client_states         | UPDATE         |
| postgres                | auth         | oauth_client_states         | SELECT         |
| postgres                | auth         | oauth_client_states         | INSERT         |
| postgres                | auth         | oauth_clients               | UPDATE         |
| postgres                | auth         | oauth_clients               | INSERT         |
| postgres                | auth         | oauth_clients               | TRIGGER        |
| postgres                | auth         | oauth_clients               | REFERENCES     |
| postgres                | auth         | oauth_clients               | TRUNCATE       |
| postgres                | auth         | oauth_clients               | DELETE         |
| postgres                | auth         | oauth_clients               | SELECT         |
| postgres                | auth         | oauth_consents              | REFERENCES     |
| postgres                | auth         | oauth_consents              | TRIGGER        |
| postgres                | auth         | oauth_consents              | TRUNCATE       |
| postgres                | auth         | oauth_consents              | DELETE         |
| postgres                | auth         | oauth_consents              | UPDATE         |
| postgres                | auth         | oauth_consents              | SELECT         |
| postgres                | auth         | oauth_consents              | INSERT         |
| postgres                | auth         | one_time_tokens             | SELECT         |
| postgres                | auth         | one_time_tokens             | INSERT         |
| postgres                | auth         | one_time_tokens             | TRIGGER        |
| postgres                | auth         | one_time_tokens             | REFERENCES     |
| postgres                | auth         | one_time_tokens             | TRUNCATE       |
| postgres                | auth         | one_time_tokens             | DELETE         |
| postgres                | auth         | one_time_tokens             | UPDATE         |
| postgres                | auth         | refresh_tokens              | INSERT         |
| postgres                | auth         | refresh_tokens              | SELECT         |
| postgres                | auth         | refresh_tokens              | UPDATE         |
| postgres                | auth         | refresh_tokens              | DELETE         |
| postgres                | auth         | refresh_tokens              | TRUNCATE       |
| postgres                | auth         | refresh_tokens              | REFERENCES     |
| postgres                | auth         | refresh_tokens              | TRIGGER        |
| postgres                | auth         | saml_providers              | TRIGGER        |
| postgres                | auth         | saml_providers              | INSERT         |
| postgres                | auth         | saml_providers              | SELECT         |
| postgres                | auth         | saml_providers              | UPDATE         |
| postgres                | auth         | saml_providers              | DELETE         |
| postgres                | auth         | saml_providers              | TRUNCATE       |
| postgres                | auth         | saml_providers              | REFERENCES     |
| postgres                | auth         | saml_relay_states           | REFERENCES     |
| postgres                | auth         | saml_relay_states           | TRUNCATE       |
| postgres                | auth         | saml_relay_states           | DELETE         |
| postgres                | auth         | saml_relay_states           | UPDATE         |
| postgres                | auth         | saml_relay_states           | SELECT         |
| postgres                | auth         | saml_relay_states           | INSERT         |
| postgres                | auth         | saml_relay_states           | TRIGGER        |
| postgres                | auth         | schema_migrations           | SELECT         |
| postgres                | auth         | sessions                    | INSERT         |
| postgres                | auth         | sessions                    | TRIGGER        |
| postgres                | auth         | sessions                    | REFERENCES     |
| postgres                | auth         | sessions                    | TRUNCATE       |
| postgres                | auth         | sessions                    | DELETE         |
| postgres                | auth         | sessions                    | UPDATE         |
| postgres                | auth         | sessions                    | SELECT         |
| postgres                | auth         | sso_domains                 | SELECT         |
| postgres                | auth         | sso_domains                 | INSERT         |
| postgres                | auth         | sso_domains                 | TRIGGER        |
| postgres                | auth         | sso_domains                 | REFERENCES     |
| postgres                | auth         | sso_domains                 | TRUNCATE       |
| postgres                | auth         | sso_domains                 | DELETE         |
| postgres                | auth         | sso_domains                 | UPDATE         |
| postgres                | auth         | sso_providers               | REFERENCES     |
| postgres                | auth         | sso_providers               | INSERT         |
| postgres                | auth         | sso_providers               | SELECT         |
| postgres                | auth         | sso_providers               | UPDATE         |
| postgres                | auth         | sso_providers               | DELETE         |
| postgres                | auth         | sso_providers               | TRUNCATE       |
| postgres                | auth         | sso_providers               | TRIGGER        |
| postgres                | auth         | users                       | INSERT         |
| postgres                | auth         | users                       | SELECT         |
| postgres                | auth         | users                       | UPDATE         |
| postgres                | auth         | users                       | DELETE         |
| postgres                | auth         | users                       | TRUNCATE       |
| postgres                | auth         | users                       | REFERENCES     |
| postgres                | auth         | users                       | TRIGGER        |
| postgres                | extensions   | pg_stat_statements          | TRIGGER        |
| postgres                | extensions   | pg_stat_statements          | SELECT         |
| postgres                | extensions   | pg_stat_statements          | UPDATE         |
| postgres                | extensions   | pg_stat_statements          | DELETE         |
| postgres                | extensions   | pg_stat_statements          | TRUNCATE       |
| postgres                | extensions   | pg_stat_statements          | INSERT         |
| postgres                | extensions   | pg_stat_statements          | REFERENCES     |
| postgres                | extensions   | pg_stat_statements_info     | REFERENCES     |
| postgres                | extensions   | pg_stat_statements_info     | SELECT         |
| postgres                | extensions   | pg_stat_statements_info     | UPDATE         |
| postgres                | extensions   | pg_stat_statements_info     | DELETE         |
| postgres                | extensions   | pg_stat_statements_info     | TRUNCATE       |
| postgres                | extensions   | pg_stat_statements_info     | INSERT         |
| postgres                | extensions   | pg_stat_statements_info     | TRIGGER        |
| postgres                | public       | client_deliverable_status   | TRIGGER        |
| postgres                | public       | client_deliverable_status   | REFERENCES     |
| postgres                | public       | client_deliverable_status   | TRUNCATE       |
| postgres                | public       | client_deliverable_status   | DELETE         |
| postgres                | public       | client_deliverable_status   | UPDATE         |
| postgres                | public       | client_deliverable_status   | SELECT         |
| postgres                | public       | client_deliverable_status   | INSERT         |
| postgres                | public       | comments                    | REFERENCES     |
| postgres                | public       | comments                    | TRUNCATE       |
| postgres                | public       | comments                    | TRIGGER        |
| postgres                | public       | comments                    | INSERT         |
| postgres                | public       | comments                    | SELECT         |
| postgres                | public       | comments                    | UPDATE         |
| postgres                | public       | comments                    | DELETE         |
| postgres                | public       | deliverable_assets          | REFERENCES     |
| postgres                | public       | deliverable_assets          | TRIGGER        |
| postgres                | public       | deliverable_assets          | TRUNCATE       |
| postgres                | public       | deliverable_assets          | DELETE         |
| postgres                | public       | deliverable_assets          | UPDATE         |
| postgres                | public       | deliverable_assets          | SELECT         |
| postgres                | public       | deliverable_assets          | INSERT         |
| postgres                | public       | deliverables                | TRIGGER        |
| postgres                | public       | deliverables                | REFERENCES     |
| postgres                | public       | deliverables                | TRUNCATE       |
| postgres                | public       | deliverables                | DELETE         |
| postgres                | public       | deliverables                | UPDATE         |
| postgres                | public       | deliverables                | SELECT         |
| postgres                | public       | deliverables                | INSERT         |
| postgres                | public       | hero_slots                  | INSERT         |
| postgres                | public       | hero_slots                  | SELECT         |
| postgres                | public       | hero_slots                  | UPDATE         |
| postgres                | public       | hero_slots                  | DELETE         |
| postgres                | public       | hero_slots                  | TRUNCATE       |
| postgres                | public       | hero_slots                  | REFERENCES     |
| postgres                | public       | hero_slots                  | TRIGGER        |
| postgres                | public       | images                      | TRIGGER        |
| postgres                | public       | images                      | INSERT         |
| postgres                | public       | images                      | SELECT         |
| postgres                | public       | images                      | UPDATE         |
| postgres                | public       | images                      | DELETE         |
| postgres                | public       | images                      | TRUNCATE       |
| postgres                | public       | images                      | REFERENCES     |
| postgres                | public       | media                       | TRIGGER        |
| postgres                | public       | media                       | INSERT         |
| postgres                | public       | media                       | SELECT         |
| postgres                | public       | media                       | UPDATE         |
| postgres                | public       | media                       | DELETE         |
| postgres                | public       | media                       | TRUNCATE       |
| postgres                | public       | media                       | REFERENCES     |
| postgres                | public       | media_assets                | REFERENCES     |
| postgres                | public       | media_assets                | TRIGGER        |
| postgres                | public       | media_assets                | TRUNCATE       |
| postgres                | public       | media_assets                | DELETE         |
| postgres                | public       | media_assets                | UPDATE         |
| postgres                | public       | media_assets                | SELECT         |
| postgres                | public       | media_assets                | INSERT         |
| postgres                | public       | notifications               | TRIGGER        |
| postgres                | public       | notifications               | INSERT         |
| postgres                | public       | notifications               | SELECT         |
| postgres                | public       | notifications               | UPDATE         |
| postgres                | public       | notifications               | DELETE         |
| postgres                | public       | notifications               | TRUNCATE       |
| postgres                | public       | notifications               | REFERENCES     |
| postgres                | public       | portfolio_items             | REFERENCES     |
| postgres                | public       | portfolio_items             | INSERT         |
| postgres                | public       | portfolio_items             | SELECT         |
| postgres                | public       | portfolio_items             | UPDATE         |
| postgres                | public       | portfolio_items             | DELETE         |
| postgres                | public       | portfolio_items             | TRUNCATE       |
| postgres                | public       | portfolio_items             | TRIGGER        |
| postgres                | public       | portfolio_items_with_images | INSERT         |
| postgres                | public       | portfolio_items_with_images | UPDATE         |
| postgres                | public       | portfolio_items_with_images | TRIGGER        |
| postgres                | public       | portfolio_items_with_images | DELETE         |
| postgres                | public       | portfolio_items_with_images | TRUNCATE       |
| postgres                | public       | portfolio_items_with_images | REFERENCES     |
| postgres                | public       | portfolio_items_with_images | SELECT         |
| postgres                | public       | profiles                    | UPDATE         |
| postgres                | public       | profiles                    | INSERT         |
| postgres                | public       | profiles                    | SELECT         |
| postgres                | public       | profiles                    | REFERENCES     |
| postgres                | public       | profiles                    | DELETE         |
| postgres                | public       | profiles                    | TRUNCATE       |
| postgres                | public       | profiles                    | TRIGGER        |
| postgres                | public       | project_clients             | TRUNCATE       |
| postgres                | public       | project_clients             | INSERT         |
| postgres                | public       | project_clients             | SELECT         |
| postgres                | public       | project_clients             | TRIGGER        |
| postgres                | public       | project_clients             | REFERENCES     |
| postgres                | public       | project_clients             | UPDATE         |
| postgres                | public       | project_clients             | DELETE         |
| postgres                | public       | project_members             | TRUNCATE       |
| postgres                | public       | project_members             | INSERT         |
| postgres                | public       | project_members             | SELECT         |
| postgres                | public       | project_members             | UPDATE         |
| postgres                | public       | project_members             | DELETE         |
| postgres                | public       | project_members             | REFERENCES     |
| postgres                | public       | project_members             | TRIGGER        |
| postgres                | public       | projects                    | TRUNCATE       |
| postgres                | public       | projects                    | INSERT         |
| postgres                | public       | projects                    | SELECT         |
| postgres                | public       | projects                    | UPDATE         |
| postgres                | public       | projects                    | DELETE         |
| postgres                | public       | projects                    | TRIGGER        |
| postgres                | public       | projects                    | REFERENCES     |
| postgres                | public       | site_images                 | REFERENCES     |
| postgres                | public       | site_images                 | DELETE         |
| postgres                | public       | site_images                 | UPDATE         |
| postgres                | public       | site_images                 | SELECT         |
| postgres                | public       | site_images                 | INSERT         |
| postgres                | public       | site_images                 | TRIGGER        |
| postgres                | public       | site_images                 | TRUNCATE       |
| postgres                | public       | user_profiles               | TRUNCATE       |
| postgres                | public       | user_profiles               | DELETE         |
| postgres                | public       | user_profiles               | UPDATE         |
| postgres                | public       | user_profiles               | REFERENCES     |
| postgres                | public       | user_profiles               | TRIGGER        |
| postgres                | public       | user_profiles               | INSERT         |
| postgres                | public       | user_profiles               | SELECT         |
| postgres                | realtime     | messages                    | SELECT         |
| postgres                | realtime     | messages                    | TRIGGER        |
| postgres                | realtime     | messages                    | REFERENCES     |
| postgres                | realtime     | messages                    | TRUNCATE       |
| postgres                | realtime     | messages                    | DELETE         |
| postgres                | realtime     | messages                    | UPDATE         |
| postgres                | realtime     | messages                    | INSERT         |
| postgres                | realtime     | schema_migrations           | TRUNCATE       |
| postgres                | realtime     | schema_migrations           | REFERENCES     |
| postgres                | realtime     | schema_migrations           | TRIGGER        |
| postgres                | realtime     | schema_migrations           | INSERT         |
| postgres                | realtime     | schema_migrations           | SELECT         |
| postgres                | realtime     | schema_migrations           | UPDATE         |
| postgres                | realtime     | schema_migrations           | DELETE         |
| postgres                | realtime     | subscription                | TRIGGER        |
| postgres                | realtime     | subscription                | TRUNCATE       |
| postgres                | realtime     | subscription                | DELETE         |
| postgres                | realtime     | subscription                | INSERT         |
| postgres                | realtime     | subscription                | UPDATE         |
| postgres                | realtime     | subscription                | SELECT         |
| postgres                | realtime     | subscription                | REFERENCES     |
| postgres                | storage      | buckets                     | UPDATE         |
| postgres                | storage      | buckets                     | TRIGGER        |
| postgres                | storage      | buckets                     | REFERENCES     |
| postgres                | storage      | buckets                     | INSERT         |
| postgres                | storage      | buckets                     | TRUNCATE       |
| postgres                | storage      | buckets                     | DELETE         |
| postgres                | storage      | buckets                     | SELECT         |
| postgres                | storage      | objects                     | TRIGGER        |
| postgres                | storage      | objects                     | INSERT         |
| postgres                | storage      | objects                     | SELECT         |
| postgres                | storage      | objects                     | UPDATE         |
| postgres                | storage      | objects                     | DELETE         |
| postgres                | storage      | objects                     | TRUNCATE       |
| postgres                | storage      | objects                     | REFERENCES     |
| postgres                | vault        | decrypted_secrets           | TRUNCATE       |
| postgres                | vault        | decrypted_secrets           | SELECT         |
| postgres                | vault        | decrypted_secrets           | DELETE         |
| postgres                | vault        | decrypted_secrets           | REFERENCES     |
| postgres                | vault        | secrets                     | REFERENCES     |
| postgres                | vault        | secrets                     | TRUNCATE       |
| postgres                | vault        | secrets                     | DELETE         |
| postgres                | vault        | secrets                     | SELECT         |
| service_role            | public       | client_deliverable_status   | INSERT         |
| service_role            | public       | client_deliverable_status   | SELECT         |
| service_role            | public       | client_deliverable_status   | UPDATE         |
| service_role            | public       | client_deliverable_status   | DELETE         |
| service_role            | public       | client_deliverable_status   | TRUNCATE       |
| service_role            | public       | client_deliverable_status   | REFERENCES     |
| service_role            | public       | client_deliverable_status   | TRIGGER        |
| service_role            | public       | comments                    | REFERENCES     |
| service_role            | public       | comments                    | TRUNCATE       |
| service_role            | public       | comments                    | DELETE         |
| service_role            | public       | comments                    | UPDATE         |
| service_role            | public       | comments                    | SELECT         |
| service_role            | public       | comments                    | TRIGGER        |
| service_role            | public       | comments                    | INSERT         |
| service_role            | public       | deliverable_assets          | SELECT         |
| service_role            | public       | deliverable_assets          | INSERT         |
| service_role            | public       | deliverable_assets          | UPDATE         |
| service_role            | public       | deliverable_assets          | DELETE         |
| service_role            | public       | deliverable_assets          | TRUNCATE       |
| service_role            | public       | deliverable_assets          | REFERENCES     |
| service_role            | public       | deliverable_assets          | TRIGGER        |
| service_role            | public       | deliverables                | REFERENCES     |
| service_role            | public       | deliverables                | TRUNCATE       |
| service_role            | public       | deliverables                | TRIGGER        |
| service_role            | public       | deliverables                | INSERT         |
| service_role            | public       | deliverables                | SELECT         |
| service_role            | public       | deliverables                | UPDATE         |
| service_role            | public       | deliverables                | DELETE         |
| service_role            | public       | hero_slots                  | SELECT         |
| service_role            | public       | hero_slots                  | TRIGGER        |
| service_role            | public       | hero_slots                  | INSERT         |
| service_role            | public       | hero_slots                  | REFERENCES     |
| service_role            | public       | hero_slots                  | TRUNCATE       |
| service_role            | public       | hero_slots                  | DELETE         |
| service_role            | public       | hero_slots                  | UPDATE         |
| service_role            | public       | images                      | REFERENCES     |
| service_role            | public       | images                      | INSERT         |
| service_role            | public       | images                      | SELECT         |
| service_role            | public       | images                      | UPDATE         |
| service_role            | public       | images                      | DELETE         |
| service_role            | public       | images                      | TRUNCATE       |
| service_role            | public       | images                      | TRIGGER        |
| service_role            | public       | media                       | INSERT         |
| service_role            | public       | media                       | TRIGGER        |
| service_role            | public       | media                       | REFERENCES     |
| service_role            | public       | media                       | TRUNCATE       |
| service_role            | public       | media                       | DELETE         |
| service_role            | public       | media                       | UPDATE         |
| service_role            | public       | media                       | SELECT         |
| service_role            | public       | media_assets                | INSERT         |
| service_role            | public       | media_assets                | TRIGGER        |
| service_role            | public       | media_assets                | REFERENCES     |
| service_role            | public       | media_assets                | TRUNCATE       |
| service_role            | public       | media_assets                | DELETE         |
| service_role            | public       | media_assets                | UPDATE         |
| service_role            | public       | media_assets                | SELECT         |
| service_role            | public       | notifications               | INSERT         |
| service_role            | public       | notifications               | UPDATE         |
| service_role            | public       | notifications               | REFERENCES     |
| service_role            | public       | notifications               | TRIGGER        |
| service_role            | public       | notifications               | SELECT         |
| service_role            | public       | notifications               | DELETE         |
| service_role            | public       | notifications               | TRUNCATE       |
| service_role            | public       | portfolio_items             | INSERT         |
| service_role            | public       | portfolio_items             | TRIGGER        |
| service_role            | public       | portfolio_items             | REFERENCES     |
| service_role            | public       | portfolio_items             | TRUNCATE       |
| service_role            | public       | portfolio_items             | DELETE         |
| service_role            | public       | portfolio_items             | UPDATE         |
| service_role            | public       | portfolio_items             | SELECT         |
| service_role            | public       | portfolio_items_with_images | REFERENCES     |
| service_role            | public       | portfolio_items_with_images | TRUNCATE       |
| service_role            | public       | portfolio_items_with_images | TRIGGER        |
| service_role            | public       | portfolio_items_with_images | INSERT         |
| service_role            | public       | portfolio_items_with_images | SELECT         |
| service_role            | public       | portfolio_items_with_images | UPDATE         |
| service_role            | public       | portfolio_items_with_images | DELETE         |
| service_role            | public       | profiles                    | SELECT         |
| service_role            | public       | profiles                    | INSERT         |
| service_role            | public       | profiles                    | TRIGGER        |
| service_role            | public       | profiles                    | REFERENCES     |
| service_role            | public       | profiles                    | TRUNCATE       |
| service_role            | public       | profiles                    | DELETE         |
| service_role            | public       | profiles                    | UPDATE         |
| service_role            | public       | project_clients             | UPDATE         |
| service_role            | public       | project_clients             | TRUNCATE       |
| service_role            | public       | project_clients             | TRIGGER        |
| service_role            | public       | project_clients             | REFERENCES     |
| service_role            | public       | project_clients             | DELETE         |
| service_role            | public       | project_clients             | INSERT         |
| service_role            | public       | project_clients             | SELECT         |
| service_role            | public       | project_members             | DELETE         |
| service_role            | public       | project_members             | UPDATE         |
| service_role            | public       | project_members             | TRIGGER        |
| service_role            | public       | project_members             | REFERENCES     |
| service_role            | public       | project_members             | TRUNCATE       |
| service_role            | public       | project_members             | SELECT         |
| service_role            | public       | project_members             | INSERT         |
| service_role            | public       | projects                    | DELETE         |
| service_role            | public       | projects                    | TRIGGER        |
| service_role            | public       | projects                    | REFERENCES     |
| service_role            | public       | projects                    | INSERT         |
| service_role            | public       | projects                    | SELECT         |
| service_role            | public       | projects                    | UPDATE         |
| service_role            | public       | projects                    | TRUNCATE       |
| service_role            | public       | site_images                 | INSERT         |
| service_role            | public       | site_images                 | REFERENCES     |
| service_role            | public       | site_images                 | TRIGGER        |
| service_role            | public       | site_images                 | TRUNCATE       |
| service_role            | public       | site_images                 | DELETE         |
| service_role            | public       | site_images                 | UPDATE         |
| service_role            | public       | site_images                 | SELECT         |
| service_role            | public       | user_profiles               | INSERT         |
| service_role            | public       | user_profiles               | TRUNCATE       |
| service_role            | public       | user_profiles               | DELETE         |
| service_role            | public       | user_profiles               | TRIGGER        |
| service_role            | public       | user_profiles               | UPDATE         |
| service_role            | public       | user_profiles               | SELECT         |
| service_role            | public       | user_profiles               | REFERENCES     |
| service_role            | realtime     | messages                    | INSERT         |
| service_role            | realtime     | messages                    | UPDATE         |
| service_role            | realtime     | messages                    | SELECT         |
| service_role            | realtime     | schema_migrations           | SELECT         |
| service_role            | realtime     | subscription                | SELECT         |
| service_role            | storage      | buckets                     | INSERT         |
| service_role            | storage      | buckets                     | SELECT         |
| service_role            | storage      | buckets                     | UPDATE         |
| service_role            | storage      | buckets                     | TRIGGER        |
| service_role            | storage      | buckets                     | REFERENCES     |
| service_role            | storage      | buckets                     | TRUNCATE       |
| service_role            | storage      | buckets                     | DELETE         |
| service_role            | storage      | buckets_analytics           | SELECT         |
| service_role            | storage      | buckets_analytics           | INSERT         |
| service_role            | storage      | buckets_analytics           | TRIGGER        |
| service_role            | storage      | buckets_analytics           | REFERENCES     |
| service_role            | storage      | buckets_analytics           | TRUNCATE       |
| service_role            | storage      | buckets_analytics           | DELETE         |
| service_role            | storage      | buckets_analytics           | UPDATE         |
| service_role            | storage      | buckets_vectors             | SELECT         |
| service_role            | storage      | objects                     | INSERT         |
| service_role            | storage      | objects                     | SELECT         |
| service_role            | storage      | objects                     | UPDATE         |
| service_role            | storage      | objects                     | DELETE         |
| service_role            | storage      | objects                     | TRUNCATE       |
| service_role            | storage      | objects                     | REFERENCES     |
| service_role            | storage      | objects                     | TRIGGER        |
| service_role            | storage      | prefixes                    | UPDATE         |
| service_role            | storage      | prefixes                    | TRIGGER        |
| service_role            | storage      | prefixes                    | REFERENCES     |
| service_role            | storage      | prefixes                    | TRUNCATE       |
| service_role            | storage      | prefixes                    | DELETE         |
| service_role            | storage      | prefixes                    | SELECT         |
| service_role            | storage      | prefixes                    | INSERT         |
| service_role            | storage      | s3_multipart_uploads        | TRIGGER        |
| service_role            | storage      | s3_multipart_uploads        | INSERT         |
| service_role            | storage      | s3_multipart_uploads        | SELECT         |
| service_role            | storage      | s3_multipart_uploads        | UPDATE         |
| service_role            | storage      | s3_multipart_uploads        | DELETE         |
| service_role            | storage      | s3_multipart_uploads        | TRUNCATE       |
| service_role            | storage      | s3_multipart_uploads        | REFERENCES     |
| service_role            | storage      | s3_multipart_uploads_parts  | REFERENCES     |
| service_role            | storage      | s3_multipart_uploads_parts  | SELECT         |
| service_role            | storage      | s3_multipart_uploads_parts  | TRIGGER        |
| service_role            | storage      | s3_multipart_uploads_parts  | UPDATE         |
| service_role            | storage      | s3_multipart_uploads_parts  | DELETE         |
| service_role            | storage      | s3_multipart_uploads_parts  | INSERT         |
| service_role            | storage      | s3_multipart_uploads_parts  | TRUNCATE       |
| service_role            | storage      | vector_indexes              | SELECT         |
| service_role            | vault        | decrypted_secrets           | DELETE         |
| service_role            | vault        | decrypted_secrets           | SELECT         |
| service_role            | vault        | secrets                     | SELECT         |
| service_role            | vault        | secrets                     | DELETE         |
| supabase_realtime_admin | realtime     | messages                    | TRIGGER        |
| supabase_realtime_admin | realtime     | messages                    | INSERT         |
| supabase_realtime_admin | realtime     | messages                    | SELECT         |
| supabase_realtime_admin | realtime     | messages                    | UPDATE         |
| supabase_realtime_admin | realtime     | messages                    | TRUNCATE       |
| supabase_realtime_admin | realtime     | messages                    | DELETE         |
| supabase_realtime_admin | realtime     | messages                    | REFERENCES     |
| supabase_realtime_admin | realtime     | schema_migrations           | DELETE         |
| supabase_realtime_admin | realtime     | schema_migrations           | UPDATE         |
| supabase_realtime_admin | realtime     | schema_migrations           | SELECT         |
| supabase_realtime_admin | realtime     | schema_migrations           | INSERT         |
| supabase_realtime_admin | realtime     | schema_migrations           | TRUNCATE       |
| supabase_realtime_admin | realtime     | schema_migrations           | REFERENCES     |
| supabase_realtime_admin | realtime     | schema_migrations           | TRIGGER        |
| supabase_realtime_admin | realtime     | subscription                | SELECT         |
| supabase_realtime_admin | realtime     | subscription                | DELETE         |
| supabase_realtime_admin | realtime     | subscription                | UPDATE         |
| supabase_realtime_admin | realtime     | subscription                | REFERENCES     |
| supabase_realtime_admin | realtime     | subscription                | INSERT         |
| supabase_realtime_admin | realtime     | subscription                | TRUNCATE       |
| supabase_realtime_admin | realtime     | subscription                | TRIGGER        |


Triggers & Functions that matter


| function_schema | function_name                         | definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| --------------- | ------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auth            | email                                 | CREATE OR REPLACE FUNCTION auth.email()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.email', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'email')
  )::text
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| auth            | jwt                                   | CREATE OR REPLACE FUNCTION auth.jwt()
 RETURNS jsonb
 LANGUAGE sql
 STABLE
AS $function$
  select 
    coalesce(
        nullif(current_setting('request.jwt.claim', true), ''),
        nullif(current_setting('request.jwt.claims', true), '')
    )::jsonb
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| auth            | role                                  | CREATE OR REPLACE FUNCTION auth.role()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.role', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'role')
  )::text
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| auth            | uid                                   | CREATE OR REPLACE FUNCTION auth.uid()
 RETURNS uuid
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.sub', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'sub')
  )::uuid
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions      | armor                                 | CREATE OR REPLACE FUNCTION extensions.armor(bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_armor$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions      | armor                                 | CREATE OR REPLACE FUNCTION extensions.armor(bytea, text[], text[])
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_armor$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions      | crypt                                 | CREATE OR REPLACE FUNCTION extensions.crypt(text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_crypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | dearmor                               | CREATE OR REPLACE FUNCTION extensions.dearmor(text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_dearmor$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions      | decrypt                               | CREATE OR REPLACE FUNCTION extensions.decrypt(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_decrypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions      | decrypt_iv                            | CREATE OR REPLACE FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_decrypt_iv$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions      | digest                                | CREATE OR REPLACE FUNCTION extensions.digest(bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_digest$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions      | digest                                | CREATE OR REPLACE FUNCTION extensions.digest(text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_digest$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions      | encrypt                               | CREATE OR REPLACE FUNCTION extensions.encrypt(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_encrypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions      | encrypt_iv                            | CREATE OR REPLACE FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_encrypt_iv$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions      | gen_random_bytes                      | CREATE OR REPLACE FUNCTION extensions.gen_random_bytes(integer)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_random_bytes$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions      | gen_random_uuid                       | CREATE OR REPLACE FUNCTION extensions.gen_random_uuid()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE
AS '$libdir/pgcrypto', $function$pg_random_uuid$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions      | gen_salt                              | CREATE OR REPLACE FUNCTION extensions.gen_salt(text)
 RETURNS text
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_gen_salt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions      | gen_salt                              | CREATE OR REPLACE FUNCTION extensions.gen_salt(text, integer)
 RETURNS text
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_gen_salt_rounds$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions      | grant_pg_cron_access                  | CREATE OR REPLACE FUNCTION extensions.grant_pg_cron_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF EXISTS (
    SELECT
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_cron'
  )
  THEN
    grant usage on schema cron to postgres with grant option;

    alter default privileges in schema cron grant all on tables to postgres with grant option;
    alter default privileges in schema cron grant all on functions to postgres with grant option;
    alter default privileges in schema cron grant all on sequences to postgres with grant option;

    alter default privileges for user supabase_admin in schema cron grant all
        on sequences to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on tables to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on functions to postgres with grant option;

    grant all privileges on all tables in schema cron to postgres with grant option;
    revoke all on table cron.job from postgres;
    grant select on table cron.job to postgres with grant option;
  END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extensions      | grant_pg_graphql_access               | CREATE OR REPLACE FUNCTION extensions.grant_pg_graphql_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    func_is_graphql_resolve bool;
BEGIN
    func_is_graphql_resolve = (
        SELECT n.proname = 'resolve'
        FROM pg_event_trigger_ddl_commands() AS ev
        LEFT JOIN pg_catalog.pg_proc AS n
        ON ev.objid = n.oid
    );

    IF func_is_graphql_resolve
    THEN
        -- Update public wrapper to pass all arguments through to the pg_graphql resolve func
        DROP FUNCTION IF EXISTS graphql_public.graphql;
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language sql
        as $$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $$;

        -- This hook executes when `graphql.resolve` is created. That is not necessarily the last
        -- function in the extension so we need to grant permissions on existing entities AND
        -- update default permissions to any others that are created after `graphql.resolve`
        grant usage on schema graphql to postgres, anon, authenticated, service_role;
        grant select on all tables in schema graphql to postgres, anon, authenticated, service_role;
        grant execute on all functions in schema graphql to postgres, anon, authenticated, service_role;
        grant all on all sequences in schema graphql to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on tables to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on functions to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on sequences to postgres, anon, authenticated, service_role;

        -- Allow postgres role to allow granting usage on graphql and graphql_public schemas to custom roles
        grant usage on schema graphql_public to postgres with grant option;
        grant usage on schema graphql to postgres with grant option;
    END IF;

END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions      | grant_pg_net_access                   | CREATE OR REPLACE FUNCTION extensions.grant_pg_net_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF EXISTS (
    SELECT 1
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_net'
  )
  THEN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_roles
      WHERE rolname = 'supabase_functions_admin'
    )
    THEN
      CREATE USER supabase_functions_admin NOINHERIT CREATEROLE LOGIN NOREPLICATION;
    END IF;

    GRANT USAGE ON SCHEMA net TO supabase_functions_admin, postgres, anon, authenticated, service_role;

    IF EXISTS (
      SELECT FROM pg_extension
      WHERE extname = 'pg_net'
      -- all versions in use on existing projects as of 2025-02-20
      -- version 0.12.0 onwards don't need these applied
      AND extversion IN ('0.2', '0.6', '0.7', '0.7.1', '0.8', '0.10.0', '0.11.0')
    ) THEN
      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;

      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;

      REVOKE ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
      REVOKE ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;

      GRANT EXECUTE ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
      GRANT EXECUTE ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
    END IF;
  END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions      | hmac                                  | CREATE OR REPLACE FUNCTION extensions.hmac(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_hmac$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions      | hmac                                  | CREATE OR REPLACE FUNCTION extensions.hmac(text, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_hmac$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions      | pg_stat_statements                    | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone)
 RETURNS SETOF record
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_1_11$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions      | pg_stat_statements_info               | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone)
 RETURNS record
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_info$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions      | pg_stat_statements_reset              | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements_reset(userid oid DEFAULT 0, dbid oid DEFAULT 0, queryid bigint DEFAULT 0, minmax_only boolean DEFAULT false)
 RETURNS timestamp with time zone
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_reset_1_11$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions      | pgp_armor_headers                     | CREATE OR REPLACE FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text)
 RETURNS SETOF record
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_armor_headers$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions      | pgp_key_id                            | CREATE OR REPLACE FUNCTION extensions.pgp_key_id(bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_key_id_w$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions      | pgp_pub_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extensions      | pgp_pub_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions      | pgp_pub_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions      | pgp_pub_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | pgp_pub_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions      | pgp_pub_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions      | pgp_pub_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt(text, bytea)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions      | pgp_pub_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt(text, bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions      | pgp_pub_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions      | pgp_pub_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions      | pgp_sym_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt(bytea, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions      | pgp_sym_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt(bytea, text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions      | pgp_sym_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions      | pgp_sym_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions      | pgp_sym_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt(text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions      | pgp_sym_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt(text, text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions      | pgp_sym_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions      | pgp_sym_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions      | pgrst_ddl_watch                       | CREATE OR REPLACE FUNCTION extensions.pgrst_ddl_watch()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
  cmd record;
BEGIN
  FOR cmd IN SELECT * FROM pg_event_trigger_ddl_commands()
  LOOP
    IF cmd.command_tag IN (
      'CREATE SCHEMA', 'ALTER SCHEMA'
    , 'CREATE TABLE', 'CREATE TABLE AS', 'SELECT INTO', 'ALTER TABLE'
    , 'CREATE FOREIGN TABLE', 'ALTER FOREIGN TABLE'
    , 'CREATE VIEW', 'ALTER VIEW'
    , 'CREATE MATERIALIZED VIEW', 'ALTER MATERIALIZED VIEW'
    , 'CREATE FUNCTION', 'ALTER FUNCTION'
    , 'CREATE TRIGGER'
    , 'CREATE TYPE', 'ALTER TYPE'
    , 'CREATE RULE'
    , 'COMMENT'
    )
    -- don't notify in case of CREATE TEMP table or other objects created on pg_temp
    AND cmd.schema_name is distinct from 'pg_temp'
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions      | pgrst_drop_watch                      | CREATE OR REPLACE FUNCTION extensions.pgrst_drop_watch()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
  obj record;
BEGIN
  FOR obj IN SELECT * FROM pg_event_trigger_dropped_objects()
  LOOP
    IF obj.object_type IN (
      'schema'
    , 'table'
    , 'foreign table'
    , 'view'
    , 'materialized view'
    , 'function'
    , 'trigger'
    , 'type'
    , 'rule'
    )
    AND obj.is_temporary IS false -- no pg_temp objects
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | set_graphql_placeholder               | CREATE OR REPLACE FUNCTION extensions.set_graphql_placeholder()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
    DECLARE
    graphql_is_dropped bool;
    BEGIN
    graphql_is_dropped = (
        SELECT ev.schema_name = 'graphql_public'
        FROM pg_event_trigger_dropped_objects() AS ev
        WHERE ev.schema_name = 'graphql_public'
    );

    IF graphql_is_dropped
    THEN
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language plpgsql
        as $$
            DECLARE
                server_version float;
            BEGIN
                server_version = (SELECT (SPLIT_PART((select version()), ' ', 2))::float);

                IF server_version >= 14 THEN
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql extension is not enabled.'
                            )
                        )
                    );
                ELSE
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql is only available on projects running Postgres 14 onwards.'
                            )
                        )
                    );
                END IF;
            END;
        $$;
    END IF;

    END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions      | uuid_generate_v1                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v1()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v1$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | uuid_generate_v1mc                    | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v1mc()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v1mc$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions      | uuid_generate_v3                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v3(namespace uuid, name text)
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v3$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions      | uuid_generate_v4                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v4()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v4$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | uuid_generate_v5                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v5(namespace uuid, name text)
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v5$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions      | uuid_nil                              | CREATE OR REPLACE FUNCTION extensions.uuid_nil()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_nil$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions      | uuid_ns_dns                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_dns()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_dns$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | uuid_ns_oid                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_oid()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_oid$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | uuid_ns_url                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_url()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_url$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions      | uuid_ns_x500                          | CREATE OR REPLACE FUNCTION extensions.uuid_ns_x500()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_x500$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| graphql         | _internal_resolve                     | CREATE OR REPLACE FUNCTION graphql._internal_resolve(query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE c
AS '$libdir/pg_graphql', $function$resolve_wrapper$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| graphql         | comment_directive                     | CREATE OR REPLACE FUNCTION graphql.comment_directive(comment_ text)
 RETURNS jsonb
 LANGUAGE sql
 IMMUTABLE
AS $function$
    /*
    comment on column public.account.name is '@graphql.name: myField'
    */
    select
        coalesce(
            (
                regexp_match(
                    comment_,
                    '@graphql\((.+)\)'
                )
            )[1]::jsonb,
            jsonb_build_object()
        )
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| graphql         | exception                             | CREATE OR REPLACE FUNCTION graphql.exception(message text)
 RETURNS text
 LANGUAGE plpgsql
AS $function$
begin
    raise exception using errcode='22000', message=message;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| graphql         | get_schema_version                    | CREATE OR REPLACE FUNCTION graphql.get_schema_version()
 RETURNS integer
 LANGUAGE sql
 SECURITY DEFINER
AS $function$
    select last_value from graphql.seq_schema_version;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| graphql         | increment_schema_version              | CREATE OR REPLACE FUNCTION graphql.increment_schema_version()
 RETURNS event_trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
begin
    perform pg_catalog.nextval('graphql.seq_schema_version');
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| graphql         | resolve                               | CREATE OR REPLACE FUNCTION graphql.resolve(query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE plpgsql
AS $function$
declare
    res jsonb;
    message_text text;
begin
  begin
    select graphql._internal_resolve("query" := "query",
                                     "variables" := "variables",
                                     "operationName" := "operationName",
                                     "extensions" := "extensions") into res;
    return res;
  exception
    when others then
    get stacked diagnostics message_text = message_text;
    return
    jsonb_build_object('data', null,
                       'errors', jsonb_build_array(jsonb_build_object('message', message_text)));
  end;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| graphql_public  | graphql                               | CREATE OR REPLACE FUNCTION graphql_public.graphql("operationName" text DEFAULT NULL::text, query text DEFAULT NULL::text, variables jsonb DEFAULT NULL::jsonb, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE sql
AS $function$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| pgbouncer       | get_auth                              | CREATE OR REPLACE FUNCTION pgbouncer.get_auth(p_usename text)
 RETURNS TABLE(username text, password text)
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO ''
AS $function$
  BEGIN
      RAISE DEBUG 'PgBouncer auth request: %', p_usename;

      RETURN QUERY
      SELECT
          rolname::text,
          CASE WHEN rolvaliduntil < now()
              THEN null
              ELSE rolpassword::text
          END
      FROM pg_authid
      WHERE rolname=$1 and rolcanlogin;
  END;
  $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public          | handle_new_user                       | CREATE OR REPLACE FUNCTION public.handle_new_user()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  INSERT INTO public.profiles (id, email, created_at)
  VALUES (NEW.id, NEW.email, now());
  RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public          | notify_deliverable_change             | CREATE OR REPLACE FUNCTION public.notify_deliverable_change()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
  v_project_id UUID;
  v_client RECORD;
  v_notification_type TEXT;
  v_title TEXT;
BEGIN
  v_project_id := NEW.project_id;

  IF NEW.status = 'delivered' AND (OLD.status IS NULL OR OLD.status != 'delivered') THEN
    v_notification_type := 'deliverable_ready';
    v_title := 'New deliverable ready for review: ' || COALESCE(NEW.title,'Deliverable');
  ELSIF NEW.status = 'approved' AND (OLD.status IS NULL OR OLD.status != 'approved') THEN
    v_notification_type := 'deliverable_approved';
    v_title := 'Deliverable approved: ' || COALESCE(NEW.title,'Deliverable');
  ELSIF NEW.status = 'revision_requested' AND (OLD.status IS NULL OR OLD.status != 'revision_requested') THEN
    v_notification_type := 'deliverable_revision_requested';
    v_title := 'Revision requested: ' || COALESCE(NEW.title,'Deliverable');
  ELSE
    RETURN NEW;
  END IF;

  -- Notify project client(s) via project_clients mapping (if any)
  FOR v_client IN
    SELECT pc.user_id FROM project_clients pc WHERE pc.project_id = v_project_id
  LOOP
    INSERT INTO notifications (user_id, type, title, entity_type, entity_id, payload, created_at)
    VALUES (
      v_client.user_id,
      v_notification_type,
      v_title,
      'deliverable',
      NEW.id,
      jsonb_build_object('project_id', v_project_id, 'deliverable_title', NEW.title),
      NOW()
    );
  END LOOP;

  -- also notify team members (project_members with admin/team)
  FOR v_client IN
    SELECT pm.user_id FROM project_members pm WHERE pm.project_id = v_project_id AND pm.role IN ('admin','team')
  LOOP
    INSERT INTO notifications (user_id, type, title, entity_type, entity_id, payload, created_at)
    VALUES (
      v_client.user_id,
      v_notification_type,
      v_title,
      'deliverable',
      NEW.id,
      jsonb_build_object('project_id', v_project_id, 'deliverable_title', NEW.title),
      NOW()
    );
  END LOOP;

  RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public          | notify_new_comment                    | CREATE OR REPLACE FUNCTION public.notify_new_comment()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
  v_deliverable RECORD;
  v_project_id UUID;
  v_user RECORD;
BEGIN
  IF NEW.deliverable_id IS NOT NULL THEN
    SELECT d.*, d.project_id INTO v_deliverable FROM deliverables d WHERE d.id = NEW.deliverable_id;
    v_project_id := v_deliverable.project_id;

    -- Notify all project client users (project_clients) except the author
    FOR v_user IN
      SELECT pc.user_id FROM project_clients pc WHERE pc.project_id = v_project_id AND pc.user_id != NEW.user_id
    LOOP
      INSERT INTO notifications (user_id, type, title, entity_type, entity_id, payload, created_at)
      VALUES (
        v_user.user_id,
        CASE WHEN NEW.parent_id IS NOT NULL THEN 'comment_reply' ELSE 'comment_added' END,
        'New comment on: ' || COALESCE(v_deliverable.title, 'Deliverable'),
        'comment',
        NEW.id,
        jsonb_build_object('deliverable_id', NEW.deliverable_id, 'comment_body', LEFT(NEW.body, 200)),
        NOW()
      );
    END LOOP;

    -- Notify all team members for the project (except author)
    FOR v_user IN
      SELECT pm.user_id FROM project_members pm WHERE pm.project_id = v_project_id AND pm.role IN ('admin','team') AND pm.user_id != NEW.user_id
    LOOP
      INSERT INTO notifications (user_id, type, title, entity_type, entity_id, payload, created_at)
      VALUES (
        v_user.user_id,
        CASE WHEN NEW.parent_id IS NOT NULL THEN 'comment_reply' ELSE 'comment_added' END,
        'New comment on: ' || COALESCE(v_deliverable.title, 'Deliverable'),
        'comment',
        NEW.id,
        jsonb_build_object('deliverable_id', NEW.deliverable_id, 'comment_body', LEFT(NEW.body, 200)),
        NOW()
      );
    END LOOP;

  ELSIF NEW.media_asset_id IS NOT NULL THEN
    -- If comment attached directly to a media asset, find project via media_assets.project_id
    SELECT ma.project_id INTO v_project_id FROM media_assets ma WHERE ma.id = NEW.media_asset_id;

    IF v_project_id IS NOT NULL THEN
      -- Notify project clients
      FOR v_user IN
        SELECT pc.user_id FROM project_clients pc WHERE pc.project_id = v_project_id AND pc.user_id != NEW.user_id
      LOOP
        INSERT INTO notifications (user_id, type, title, entity_type, entity_id, payload, created_at)
        VALUES (
          v_user.user_id,
          'comment_added',
          'New comment on an asset',
          'comment',
          NEW.id,
          jsonb_build_object('media_asset_id', NEW.media_asset_id, 'comment_body', LEFT(NEW.body, 200)),
          NOW()
        );
      END LOOP;

      -- Notify team members
      FOR v_user IN
        SELECT pm.user_id FROM project_members pm WHERE pm.project_id = v_project_id AND pm.role IN ('admin','team') AND pm.user_id != NEW.user_id
      LOOP
        INSERT INTO notifications (user_id, type, title, entity_type, entity_id, payload, created_at)
        VALUES (
          v_user.user_id,
          'comment_added',
          'New comment on an asset',
          'comment',
          NEW.id,
          jsonb_build_object('media_asset_id', NEW.media_asset_id, 'comment_body', LEFT(NEW.body, 200)),
          NOW()
        );
      END LOOP;
    END IF;
  END IF;

  RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public          | update_updated_at_column              | CREATE OR REPLACE FUNCTION public.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| realtime        | apply_rls                             | CREATE OR REPLACE FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer DEFAULT (1024 * 1024))
 RETURNS SETOF realtime.wal_rls
 LANGUAGE plpgsql
AS $function$
declare
-- Regclass of the table e.g. public.notes
entity_ regclass = (quote_ident(wal ->> 'schema') || '.' || quote_ident(wal ->> 'table'))::regclass;

-- I, U, D, T: insert, update ...
action realtime.action = (
    case wal ->> 'action'
        when 'I' then 'INSERT'
        when 'U' then 'UPDATE'
        when 'D' then 'DELETE'
        else 'ERROR'
    end
);

-- Is row level security enabled for the table
is_rls_enabled bool = relrowsecurity from pg_class where oid = entity_;

subscriptions realtime.subscription[] = array_agg(subs)
    from
        realtime.subscription subs
    where
        subs.entity = entity_;

-- Subscription vars
roles regrole[] = array_agg(distinct us.claims_role::text)
    from
        unnest(subscriptions) us;

working_role regrole;
claimed_role regrole;
claims jsonb;

subscription_id uuid;
subscription_has_access bool;
visible_to_subscription_ids uuid[] = '{}';

-- structured info for wal's columns
columns realtime.wal_column[];
-- previous identity values for update/delete
old_columns realtime.wal_column[];

error_record_exceeds_max_size boolean = octet_length(wal::text) > max_record_bytes;

-- Primary jsonb output for record
output jsonb;

begin
perform set_config('role', null, true);

columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'columns') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

old_columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'identity') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

for working_role in select * from unnest(roles) loop

    -- Update `is_selectable` for columns and old_columns
    columns =
        array_agg(
            (
                c.name,
                c.type_name,
                c.type_oid,
                c.value,
                c.is_pkey,
                pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
            )::realtime.wal_column
        )
        from
            unnest(columns) c;

    old_columns =
            array_agg(
                (
                    c.name,
                    c.type_name,
                    c.type_oid,
                    c.value,
                    c.is_pkey,
                    pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
                )::realtime.wal_column
            )
            from
                unnest(old_columns) c;

    if action <> 'DELETE' and count(1) = 0 from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            -- subscriptions is already filtered by entity
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 400: Bad Request, no primary key']
        )::realtime.wal_rls;

    -- The claims role does not have SELECT permission to the primary key of entity
    elsif action <> 'DELETE' and sum(c.is_selectable::int) <> count(1) from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 401: Unauthorized']
        )::realtime.wal_rls;

    else
        output = jsonb_build_object(
            'schema', wal ->> 'schema',
            'table', wal ->> 'table',
            'type', action,
            'commit_timestamp', to_char(
                ((wal ->> 'timestamp')::timestamptz at time zone 'utc'),
                'YYYY-MM-DD"T"HH24:MI:SS.MS"Z"'
            ),
            'columns', (
                select
                    jsonb_agg(
                        jsonb_build_object(
                            'name', pa.attname,
                            'type', pt.typname
                        )
                        order by pa.attnum asc
                    )
                from
                    pg_attribute pa
                    join pg_type pt
                        on pa.atttypid = pt.oid
                where
                    attrelid = entity_
                    and attnum > 0
                    and pg_catalog.has_column_privilege(working_role, entity_, pa.attname, 'SELECT')
            )
        )
        -- Add "record" key for insert and update
        || case
            when action in ('INSERT', 'UPDATE') then
                jsonb_build_object(
                    'record',
                    (
                        select
                            jsonb_object_agg(
                                -- if unchanged toast, get column name and value from old record
                                coalesce((c).name, (oc).name),
                                case
                                    when (c).name is null then (oc).value
                                    else (c).value
                                end
                            )
                        from
                            unnest(columns) c
                            full outer join unnest(old_columns) oc
                                on (c).name = (oc).name
                        where
                            coalesce((c).is_selectable, (oc).is_selectable)
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                    )
                )
            else '{}'::jsonb
        end
        -- Add "old_record" key for update and delete
        || case
            when action = 'UPDATE' then
                jsonb_build_object(
                        'old_record',
                        (
                            select jsonb_object_agg((c).name, (c).value)
                            from unnest(old_columns) c
                            where
                                (c).is_selectable
                                and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                        )
                    )
            when action = 'DELETE' then
                jsonb_build_object(
                    'old_record',
                    (
                        select jsonb_object_agg((c).name, (c).value)
                        from unnest(old_columns) c
                        where
                            (c).is_selectable
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                            and ( not is_rls_enabled or (c).is_pkey ) -- if RLS enabled, we can't secure deletes so filter to pkey
                    )
                )
            else '{}'::jsonb
        end;

        -- Create the prepared statement
        if is_rls_enabled and action <> 'DELETE' then
            if (select 1 from pg_prepared_statements where name = 'walrus_rls_stmt' limit 1) > 0 then
                deallocate walrus_rls_stmt;
            end if;
            execute realtime.build_prepared_statement_sql('walrus_rls_stmt', entity_, columns);
        end if;

        visible_to_subscription_ids = '{}';

        for subscription_id, claims in (
                select
                    subs.subscription_id,
                    subs.claims
                from
                    unnest(subscriptions) subs
                where
                    subs.entity = entity_
                    and subs.claims_role = working_role
                    and (
                        realtime.is_visible_through_filters(columns, subs.filters)
                        or (
                          action = 'DELETE'
                          and realtime.is_visible_through_filters(old_columns, subs.filters)
                        )
                    )
        ) loop

            if not is_rls_enabled or action = 'DELETE' then
                visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
            else
                -- Check if RLS allows the role to see the record
                perform
                    -- Trim leading and trailing quotes from working_role because set_config
                    -- doesn't recognize the role as valid if they are included
                    set_config('role', trim(both '"' from working_role::text), true),
                    set_config('request.jwt.claims', claims::text, true);

                execute 'execute walrus_rls_stmt' into subscription_has_access;

                if subscription_has_access then
                    visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
                end if;
            end if;
        end loop;

        perform set_config('role', null, true);

        return next (
            output,
            is_rls_enabled,
            visible_to_subscription_ids,
            case
                when error_record_exceeds_max_size then array['Error 413: Payload Too Large']
                else '{}'
            end
        )::realtime.wal_rls;

    end if;
end loop;

perform set_config('role', null, true);
end;
$function$
 |
| realtime        | broadcast_changes                     | CREATE OR REPLACE FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text DEFAULT 'ROW'::text)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
DECLARE
    -- Declare a variable to hold the JSONB representation of the row
    row_data jsonb := '{}'::jsonb;
BEGIN
    IF level = 'STATEMENT' THEN
        RAISE EXCEPTION 'function can only be triggered for each row, not for each statement';
    END IF;
    -- Check the operation type and handle accordingly
    IF operation = 'INSERT' OR operation = 'UPDATE' OR operation = 'DELETE' THEN
        row_data := jsonb_build_object('old_record', OLD, 'record', NEW, 'operation', operation, 'table', table_name, 'schema', table_schema);
        PERFORM realtime.send (row_data, event_name, topic_name);
    ELSE
        RAISE EXCEPTION 'Unexpected operation type: %', operation;
    END IF;
EXCEPTION
    WHEN OTHERS THEN
        RAISE EXCEPTION 'Failed to process the row: %', SQLERRM;
END;

$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| realtime        | build_prepared_statement_sql          | CREATE OR REPLACE FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[])
 RETURNS text
 LANGUAGE sql
AS $function$
      /*
      Builds a sql string that, if executed, creates a prepared statement to
      tests retrive a row from *entity* by its primary key columns.
      Example
          select realtime.build_prepared_statement_sql('public.notes', '{"id"}'::text[], '{"bigint"}'::text[])
      */
          select
      'prepare ' || prepared_statement_name || ' as
          select
              exists(
                  select
                      1
                  from
                      ' || entity || '
                  where
                      ' || string_agg(quote_ident(pkc.name) || '=' || quote_nullable(pkc.value #>> '{}') , ' and ') || '
              )'
          from
              unnest(columns) pkc
          where
              pkc.is_pkey
          group by
              entity
      $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| realtime        | cast                                  | CREATE OR REPLACE FUNCTION realtime."cast"(val text, type_ regtype)
 RETURNS jsonb
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
    declare
      res jsonb;
    begin
      execute format('select to_jsonb(%L::'|| type_::text || ')', val)  into res;
      return res;
    end
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| realtime        | check_equality_op                     | CREATE OR REPLACE FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text)
 RETURNS boolean
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
      /*
      Casts *val_1* and *val_2* as type *type_* and check the *op* condition for truthiness
      */
      declare
          op_symbol text = (
              case
                  when op = 'eq' then '='
                  when op = 'neq' then '!='
                  when op = 'lt' then '<'
                  when op = 'lte' then '<='
                  when op = 'gt' then '>'
                  when op = 'gte' then '>='
                  when op = 'in' then '= any'
                  else 'UNKNOWN OP'
              end
          );
          res boolean;
      begin
          execute format(
              'select %L::'|| type_::text || ' ' || op_symbol
              || ' ( %L::'
              || (
                  case
                      when op = 'in' then type_::text || '[]'
                      else type_::text end
              )
              || ')', val_1, val_2) into res;
          return res;
      end;
      $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| realtime        | is_visible_through_filters            | CREATE OR REPLACE FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[])
 RETURNS boolean
 LANGUAGE sql
 IMMUTABLE
AS $function$
    /*
    Should the record be visible (true) or filtered out (false) after *filters* are applied
    */
        select
            -- Default to allowed when no filters present
            $2 is null -- no filters. this should not happen because subscriptions has a default
            or array_length($2, 1) is null -- array length of an empty array is null
            or bool_and(
                coalesce(
                    realtime.check_equality_op(
                        op:=f.op,
                        type_:=coalesce(
                            col.type_oid::regtype, -- null when wal2json version <= 2.4
                            col.type_name::regtype
                        ),
                        -- cast jsonb to text
                        val_1:=col.value #>> '{}',
                        val_2:=f.value
                    ),
                    false -- if null, filter does not match
                )
            )
        from
            unnest(filters) f
            join unnest(columns) col
                on f.column_name = col.name;
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| realtime        | list_changes                          | CREATE OR REPLACE FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer)
 RETURNS SETOF realtime.wal_rls
 LANGUAGE sql
 SET log_min_messages TO 'fatal'
AS $function$
      with pub as (
        select
          concat_ws(
            ',',
            case when bool_or(pubinsert) then 'insert' else null end,
            case when bool_or(pubupdate) then 'update' else null end,
            case when bool_or(pubdelete) then 'delete' else null end
          ) as w2j_actions,
          coalesce(
            string_agg(
              realtime.quote_wal2json(format('%I.%I', schemaname, tablename)::regclass),
              ','
            ) filter (where ppt.tablename is not null and ppt.tablename not like '% %'),
            ''
          ) w2j_add_tables
        from
          pg_publication pp
          left join pg_publication_tables ppt
            on pp.pubname = ppt.pubname
        where
          pp.pubname = publication
        group by
          pp.pubname
        limit 1
      ),
      w2j as (
        select
          x.*, pub.w2j_add_tables
        from
          pub,
          pg_logical_slot_get_changes(
            slot_name, null, max_changes,
            'include-pk', 'true',
            'include-transaction', 'false',
            'include-timestamp', 'true',
            'include-type-oids', 'true',
            'format-version', '2',
            'actions', pub.w2j_actions,
            'add-tables', pub.w2j_add_tables
          ) x
      )
      select
        xyz.wal,
        xyz.is_rls_enabled,
        xyz.subscription_ids,
        xyz.errors
      from
        w2j,
        realtime.apply_rls(
          wal := w2j.data::jsonb,
          max_record_bytes := max_record_bytes
        ) xyz(wal, is_rls_enabled, subscription_ids, errors)
      where
        w2j.w2j_add_tables <> ''
        and xyz.subscription_ids[1] is not null
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| realtime        | quote_wal2json                        | CREATE OR REPLACE FUNCTION realtime.quote_wal2json(entity regclass)
 RETURNS text
 LANGUAGE sql
 IMMUTABLE STRICT
AS $function$
      select
        (
          select string_agg('' || ch,'')
          from unnest(string_to_array(nsp.nspname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
        )
        || '.'
        || (
          select string_agg('' || ch,'')
          from unnest(string_to_array(pc.relname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
          )
      from
        pg_class pc
        join pg_namespace nsp
          on pc.relnamespace = nsp.oid
      where
        pc.oid = entity
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| realtime        | send                                  | CREATE OR REPLACE FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean DEFAULT true)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
DECLARE
  generated_id uuid;
  final_payload jsonb;
BEGIN
  BEGIN
    -- Generate a new UUID for the id
    generated_id := gen_random_uuid();

    -- Check if payload has an 'id' key, if not, add the generated UUID
    IF payload ? 'id' THEN
      final_payload := payload;
    ELSE
      final_payload := jsonb_set(payload, '{id}', to_jsonb(generated_id));
    END IF;

    -- Set the topic configuration
    EXECUTE format('SET LOCAL realtime.topic TO %L', topic);

    -- Attempt to insert the message
    INSERT INTO realtime.messages (id, payload, event, topic, private, extension)
    VALUES (generated_id, final_payload, event, topic, private, 'broadcast');
  EXCEPTION
    WHEN OTHERS THEN
      -- Capture and notify the error
      RAISE WARNING 'ErrorSendingBroadcastMessage: %', SQLERRM;
  END;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| realtime        | subscription_check_filters            | CREATE OR REPLACE FUNCTION realtime.subscription_check_filters()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
    /*
    Validates that the user defined filters for a subscription:
    - refer to valid columns that the claimed role may access
    - values are coercable to the correct column type
    */
    declare
        col_names text[] = coalesce(
                array_agg(c.column_name order by c.ordinal_position),
                '{}'::text[]
            )
            from
                information_schema.columns c
            where
                format('%I.%I', c.table_schema, c.table_name)::regclass = new.entity
                and pg_catalog.has_column_privilege(
                    (new.claims ->> 'role'),
                    format('%I.%I', c.table_schema, c.table_name)::regclass,
                    c.column_name,
                    'SELECT'
                );
        filter realtime.user_defined_filter;
        col_type regtype;

        in_val jsonb;
    begin
        for filter in select * from unnest(new.filters) loop
            -- Filtered column is valid
            if not filter.column_name = any(col_names) then
                raise exception 'invalid column for filter %', filter.column_name;
            end if;

            -- Type is sanitized and safe for string interpolation
            col_type = (
                select atttypid::regtype
                from pg_catalog.pg_attribute
                where attrelid = new.entity
                      and attname = filter.column_name
            );
            if col_type is null then
                raise exception 'failed to lookup type for column %', filter.column_name;
            end if;

            -- Set maximum number of entries for in filter
            if filter.op = 'in'::realtime.equality_op then
                in_val = realtime.cast(filter.value, (col_type::text || '[]')::regtype);
                if coalesce(jsonb_array_length(in_val), 0) > 100 then
                    raise exception 'too many values for `in` filter. Maximum 100';
                end if;
            else
                -- raises an exception if value is not coercable to type
                perform realtime.cast(filter.value, col_type);
            end if;

        end loop;

        -- Apply consistent order to filters so the unique constraint on
        -- (subscription_id, entity, filters) can't be tricked by a different filter order
        new.filters = coalesce(
            array_agg(f order by f.column_name, f.op, f.value),
            '{}'
        ) from unnest(new.filters) f;

        return new;
    end;
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| realtime        | to_regrole                            | CREATE OR REPLACE FUNCTION realtime.to_regrole(role_name text)
 RETURNS regrole
 LANGUAGE sql
 IMMUTABLE
AS $function$ select role_name::regrole $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| realtime        | topic                                 | CREATE OR REPLACE FUNCTION realtime.topic()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
select nullif(current_setting('realtime.topic', true), '')::text;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| storage         | add_prefixes                          | CREATE OR REPLACE FUNCTION storage.add_prefixes(_bucket_id text, _name text)
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    prefixes text[];
BEGIN
    prefixes := "storage"."get_prefixes"("_name");

    IF array_length(prefixes, 1) > 0 THEN
        INSERT INTO storage.prefixes (name, bucket_id)
        SELECT UNNEST(prefixes) as name, "_bucket_id" ON CONFLICT DO NOTHING;
    END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| storage         | can_insert_object                     | CREATE OR REPLACE FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  INSERT INTO "storage"."objects" ("bucket_id", "name", "owner", "metadata") VALUES (bucketid, name, owner, metadata);
  -- hack to rollback the successful insert
  RAISE sqlstate 'PT200' using
  message = 'ROLLBACK',
  detail = 'rollback successful insert';
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| storage         | delete_leaf_prefixes                  | CREATE OR REPLACE FUNCTION storage.delete_leaf_prefixes(bucket_ids text[], names text[])
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_rows_deleted integer;
BEGIN
    LOOP
        WITH candidates AS (
            SELECT DISTINCT
                t.bucket_id,
                unnest(storage.get_prefixes(t.name)) AS name
            FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        ),
        uniq AS (
             SELECT
                 bucket_id,
                 name,
                 storage.get_level(name) AS level
             FROM candidates
             WHERE name <> ''
             GROUP BY bucket_id, name
        ),
        leaf AS (
             SELECT
                 p.bucket_id,
                 p.name,
                 p.level
             FROM storage.prefixes AS p
                  JOIN uniq AS u
                       ON u.bucket_id = p.bucket_id
                           AND u.name = p.name
                           AND u.level = p.level
             WHERE NOT EXISTS (
                 SELECT 1
                 FROM storage.objects AS o
                 WHERE o.bucket_id = p.bucket_id
                   AND o.level = p.level + 1
                   AND o.name COLLATE "C" LIKE p.name || '/%'
             )
             AND NOT EXISTS (
                 SELECT 1
                 FROM storage.prefixes AS c
                 WHERE c.bucket_id = p.bucket_id
                   AND c.level = p.level + 1
                   AND c.name COLLATE "C" LIKE p.name || '/%'
             )
        )
        DELETE
        FROM storage.prefixes AS p
            USING leaf AS l
        WHERE p.bucket_id = l.bucket_id
          AND p.name = l.name
          AND p.level = l.level;

        GET DIAGNOSTICS v_rows_deleted = ROW_COUNT;
        EXIT WHEN v_rows_deleted = 0;
    END LOOP;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| storage         | delete_prefix                         | CREATE OR REPLACE FUNCTION storage.delete_prefix(_bucket_id text, _name text)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    -- Check if we can delete the prefix
    IF EXISTS(
        SELECT FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name") + 1
          AND "prefixes"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    )
    OR EXISTS(
        SELECT FROM "storage"."objects"
        WHERE "objects"."bucket_id" = "_bucket_id"
          AND "storage"."get_level"("objects"."name") = "storage"."get_level"("_name") + 1
          AND "objects"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    ) THEN
    -- There are sub-objects, skip deletion
    RETURN false;
    ELSE
        DELETE FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name")
          AND "prefixes"."name" = "_name";
        RETURN true;
    END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| storage         | delete_prefix_hierarchy_trigger       | CREATE OR REPLACE FUNCTION storage.delete_prefix_hierarchy_trigger()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    prefix text;
BEGIN
    prefix := "storage"."get_prefix"(OLD."name");

    IF coalesce(prefix, '') != '' THEN
        PERFORM "storage"."delete_prefix"(OLD."bucket_id", prefix);
    END IF;

    RETURN OLD;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| storage         | enforce_bucket_name_length            | CREATE OR REPLACE FUNCTION storage.enforce_bucket_name_length()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
begin
    if length(new.name) > 100 then
        raise exception 'bucket name "%" is too long (% characters). Max is 100.', new.name, length(new.name);
    end if;
    return new;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| storage         | extension                             | CREATE OR REPLACE FUNCTION storage.extension(name text)
 RETURNS text
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
DECLARE
    _parts text[];
    _filename text;
BEGIN
    SELECT string_to_array(name, '/') INTO _parts;
    SELECT _parts[array_length(_parts,1)] INTO _filename;
    RETURN reverse(split_part(reverse(_filename), '.', 1));
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| storage         | filename                              | CREATE OR REPLACE FUNCTION storage.filename(name text)
 RETURNS text
 LANGUAGE plpgsql
AS $function$
DECLARE
_parts text[];
BEGIN
	select string_to_array(name, '/') into _parts;
	return _parts[array_length(_parts,1)];
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| storage         | foldername                            | CREATE OR REPLACE FUNCTION storage.foldername(name text)
 RETURNS text[]
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
DECLARE
    _parts text[];
BEGIN
    -- Split on "/" to get path segments
    SELECT string_to_array(name, '/') INTO _parts;
    -- Return everything except the last segment
    RETURN _parts[1 : array_length(_parts,1) - 1];
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage         | get_level                             | CREATE OR REPLACE FUNCTION storage.get_level(name text)
 RETURNS integer
 LANGUAGE sql
 IMMUTABLE STRICT
AS $function$
SELECT array_length(string_to_array("name", '/'), 1);
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| storage         | get_prefix                            | CREATE OR REPLACE FUNCTION storage.get_prefix(name text)
 RETURNS text
 LANGUAGE sql
 IMMUTABLE STRICT
AS $function$
SELECT
    CASE WHEN strpos("name", '/') > 0 THEN
             regexp_replace("name", '[\/]{1}[^\/]+\/?$', '')
         ELSE
             ''
        END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| storage         | get_prefixes                          | CREATE OR REPLACE FUNCTION storage.get_prefixes(name text)
 RETURNS text[]
 LANGUAGE plpgsql
 IMMUTABLE STRICT
AS $function$
DECLARE
    parts text[];
    prefixes text[];
    prefix text;
BEGIN
    -- Split the name into parts by '/'
    parts := string_to_array("name", '/');
    prefixes := '{}';

    -- Construct the prefixes, stopping one level below the last part
    FOR i IN 1..array_length(parts, 1) - 1 LOOP
            prefix := array_to_string(parts[1:i], '/');
            prefixes := array_append(prefixes, prefix);
    END LOOP;

    RETURN prefixes;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage         | get_size_by_bucket                    | CREATE OR REPLACE FUNCTION storage.get_size_by_bucket()
 RETURNS TABLE(size bigint, bucket_id text)
 LANGUAGE plpgsql
 STABLE
AS $function$
BEGIN
    return query
        select sum((metadata->>'size')::bigint) as size, obj.bucket_id
        from "storage".objects as obj
        group by obj.bucket_id;
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| storage         | list_multipart_uploads_with_delimiter | CREATE OR REPLACE FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, next_key_token text DEFAULT ''::text, next_upload_token text DEFAULT ''::text)
 RETURNS TABLE(key text, id text, created_at timestamp with time zone)
 LANGUAGE plpgsql
AS $function$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(key COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                        substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1)))
                    ELSE
                        key
                END AS key, id, created_at
            FROM
                storage.s3_multipart_uploads
            WHERE
                bucket_id = $5 AND
                key ILIKE $1 || ''%'' AND
                CASE
                    WHEN $4 != '''' AND $6 = '''' THEN
                        CASE
                            WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                                substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                key COLLATE "C" > $4
                            END
                    ELSE
                        true
                END AND
                CASE
                    WHEN $6 != '''' THEN
                        id COLLATE "C" > $6
                    ELSE
                        true
                    END
            ORDER BY
                key COLLATE "C" ASC, created_at ASC) as e order by key COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_key_token, bucket_id, next_upload_token;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| storage         | list_objects_with_delimiter           | CREATE OR REPLACE FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, start_after text DEFAULT ''::text, next_token text DEFAULT ''::text)
 RETURNS TABLE(name text, id uuid, metadata jsonb, updated_at timestamp with time zone)
 LANGUAGE plpgsql
AS $function$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(name COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                        substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1)))
                    ELSE
                        name
                END AS name, id, metadata, updated_at
            FROM
                storage.objects
            WHERE
                bucket_id = $5 AND
                name ILIKE $1 || ''%'' AND
                CASE
                    WHEN $6 != '''' THEN
                    name COLLATE "C" > $6
                ELSE true END
                AND CASE
                    WHEN $4 != '''' THEN
                        CASE
                            WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                                substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                name COLLATE "C" > $4
                            END
                    ELSE
                        true
                END
            ORDER BY
                name COLLATE "C" ASC) as e order by name COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_token, bucket_id, start_after;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| storage         | lock_top_prefixes                     | CREATE OR REPLACE FUNCTION storage.lock_top_prefixes(bucket_ids text[], names text[])
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_bucket text;
    v_top text;
BEGIN
    FOR v_bucket, v_top IN
        SELECT DISTINCT t.bucket_id,
            split_part(t.name, '/', 1) AS top
        FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        WHERE t.name <> ''
        ORDER BY 1, 2
        LOOP
            PERFORM pg_advisory_xact_lock(hashtextextended(v_bucket || '/' || v_top, 0));
        END LOOP;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| storage         | objects_delete_cleanup                | CREATE OR REPLACE FUNCTION storage.objects_delete_cleanup()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_bucket_ids text[];
    v_names      text[];
BEGIN
    IF current_setting('storage.gc.prefixes', true) = '1' THEN
        RETURN NULL;
    END IF;

    PERFORM set_config('storage.gc.prefixes', '1', true);

    SELECT COALESCE(array_agg(d.bucket_id), '{}'),
           COALESCE(array_agg(d.name), '{}')
    INTO v_bucket_ids, v_names
    FROM deleted AS d
    WHERE d.name <> '';

    PERFORM storage.lock_top_prefixes(v_bucket_ids, v_names);
    PERFORM storage.delete_leaf_prefixes(v_bucket_ids, v_names);

    RETURN NULL;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |



